<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ´Ø®ÙŠØµ - Ù…Ø³Ø§Ø¹Ø¯ Ø·Ø¨ÙŠ Ø°ÙƒÙŠ</title>
    <meta name="description" content="Ø§ÙˆØµÙ Ø£Ø¹Ø±Ø§Ø¶Ùƒ ÙˆØ§Ø­ØµÙ„ Ø¹Ù„Ù‰ ØªØ­Ù„ÙŠÙ„ ÙˆØªØ´Ø®ÙŠØµ Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap RTL -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.rtl.min.css">
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;500;600;700;800&family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <!-- Unified Theme CSS -->
    <link rel="stylesheet" href="css/unified-theme.css">
    <!-- Medical Enhancements CSS -->
    <link rel="stylesheet" href="css/medical-enhancements.css">
    <style>

        /* Chat Container Styles */
        .chat-container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .chat-header {
            background: linear-gradient(135deg, #007bff, #0056b3) !important;
        }

        .quick-action-btn {
            padding: 1rem;
            height: auto;
            border-radius: 15px;
            transition: all 0.3s ease;
        }

        .quick-action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 123, 255, 0.3);
        }

        .quick-action-btn i {
            font-size: 1.5rem;
        }

        /* Message Styles */
        .message {
            margin-bottom: 1rem;
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
        }

        .message.user {
            flex-direction: row-reverse;
        }

        .message-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: white;
            flex-shrink: 0;
        }

        .message.user .message-avatar {
            background: linear-gradient(45deg, #007bff, #0056b3);
        }

        .message.bot .message-avatar {
            background: linear-gradient(45deg, #28a745, #1e7e34);
        }

        .message-content {
            background: #f8f9fa;
            padding: 0.75rem 1rem;
            border-radius: 18px;
            max-width: 70%;
            position: relative;
            line-height: 1.6;
            word-wrap: break-word;
        }

        .message.user .message-content {
            background: linear-gradient(45deg, #007bff, #0056b3);
            color: white;
        }

        .message-time {
            font-size: 0.75rem;
            color: #6c757d;
            margin-top: 0.25rem;
        }

        .message.user .message-time {
            color: rgba(255, 255, 255, 0.8);
        }

        /* Typing Indicator */
        .typing-dots {
            display: flex;
            gap: 4px;
        }

        .typing-dots span {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #007bff;
            animation: typing 1.4s infinite ease-in-out;
        }

        .typing-dots span:nth-child(1) { animation-delay: -0.32s; }
        .typing-dots span:nth-child(2) { animation-delay: -0.16s; }

        @keyframes typing {
            0%, 80%, 100% { transform: scale(0); opacity: 0.5; }
            40% { transform: scale(1); opacity: 1; }
        }

        /* Input Styles */
        #messageInput {
            border: 2px solid #e9ecef;
            border-radius: 25px;
            padding: 0.75rem 1rem;
            transition: all 0.3s ease;
        }

        #messageInput:focus {
            border-color: #007bff;
            box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
        }

        #sendBtn {
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        #sendBtn:not(:disabled):hover {
            transform: scale(1.1);
            box-shadow: 0 5px 15px rgba(0, 123, 255, 0.4);
        }

        #sendBtn:disabled {
            background-color: #e9ecef;
            border-color: #e9ecef;
            color: #6c757d;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .message-content {
                max-width: 85%;
            }

            .quick-action-btn {
                padding: 0.75rem;
            }

            .quick-action-btn i {
                font-size: 1.25rem;
            }
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg">
        <div class="container">
            <a class="navbar-brand" href="index.html">
                <i class="fas fa-heartbeat me-2"></i>
                Ù…Ø³Ø§Ø¹Ø¯ Ø·Ø¨ÙŠ Ø°ÙƒÙŠ
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="index.html">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="diagnosis.html">Ø§Ù„ØªØ´Ø®ÙŠØµ</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="appointments.html">Ø­Ø¬Ø² Ù…ÙˆØ¹Ø¯</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="team.html">Ø§Ù„Ù‚Ø§Ø¦Ù…ÙˆÙ† Ø¨Ø§Ù„Ø¹Ù…Ù„</a>
                    </li>
                    <li class="nav-item" id="userMenuContainer" style="display: none;">
                        <div class="dropdown">
                            <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                <i class="fas fa-user-circle me-1"></i>
                                <span id="userDisplayName">Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</span>
                            </a>
                            <ul class="dropdown-menu">
                                <li><a class="dropdown-item" href="my-appointments.html"><i class="fas fa-calendar me-2"></i>Ù…ÙˆØ§Ø¹ÙŠØ¯ÙŠ</a></li>
                                <li><a class="dropdown-item" href="profile.html"><i class="fas fa-user me-2"></i>Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item" href="#" id="logoutBtn"><i class="fas fa-sign-out-alt me-2"></i>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</a></li>
                            </ul>
                        </div>
                    </li>
                    <li class="nav-item" id="loginMenuContainer">
                        <a href="login.html" class="btn btn-outline-primary">
                            <i class="fas fa-sign-in-alt me-1"></i>
                            ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    
    <!-- Main Content -->
    <main class="py-5 py-md-6 mt-5">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-10">
                    <!-- Medical Chatbot Interface -->
                    <div class="chat-container bg-white rounded-4 shadow-lg overflow-hidden">
                        <!-- Chat Header -->
                        <div class="chat-header bg-primary text-white p-4">
                            <div class="d-flex align-items-center justify-content-between">
                                <div class="d-flex align-items-center">
                                    <i class="fas fa-robot fs-2 me-3"></i>
                                    <div>
                                        <h2 class="h4 mb-1">Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø·Ø¨ÙŠ Ø§Ù„Ø°ÙƒÙŠ</h2>
                                        <p class="mb-0 opacity-75">Ø§Ø³Ø£Ù„ Ø¹Ù† Ø£Ø¹Ø±Ø§Ø¶Ùƒ ÙˆØ§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ù…Ø³Ø§Ø¹Ø¯Ø© ÙÙˆØ±ÙŠØ©</p>
                                    </div>
                                </div>
                                <div class="d-flex gap-2">
                                    <button class="btn btn-outline-light btn-sm" id="clearChatBtn" title="Ù…Ø³Ø­ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                    <button class="btn btn-outline-light btn-sm" id="exportChatBtn" title="ØªØµØ¯ÙŠØ± Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©">
                                        <i class="fas fa-download"></i>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Welcome Message -->
                        <div class="welcome-section p-5 text-center border-bottom" id="welcomeSection">
                            <div class="mb-4">
                                <i class="fas fa-stethoscope text-primary" style="font-size: 4rem;"></i>
                            </div>
                            <h3 class="h4 mb-3">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø·Ø¨ÙŠ Ø§Ù„Ø°ÙƒÙŠ</h3>
                            <p class="text-muted mb-4">Ø£Ù†Ø§ Ù‡Ù†Ø§ Ù„Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ ÙÙŠ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø·Ø¨ÙŠØ© ÙˆØ§Ù„Ø¥Ø³Ø¹Ø§ÙØ§Øª Ø§Ù„Ø£ÙˆÙ„ÙŠØ©</p>

                            <!-- Quick Action Buttons -->
                            <div class="row g-3">
                                <div class="col-md-3 col-6">
                                    <button class="btn btn-outline-primary w-100 quick-action-btn" data-message="Ø£Ø¹Ø§Ù†ÙŠ Ù…Ù† ØµØ¯Ø§Ø¹ Ø´Ø¯ÙŠØ¯">
                                        <i class="fas fa-head-side-virus d-block mb-2"></i>
                                        <small>ØµØ¯Ø§Ø¹</small>
                                    </button>
                                </div>
                                <div class="col-md-3 col-6">
                                    <button class="btn btn-outline-primary w-100 quick-action-btn" data-message="Ø¹Ù†Ø¯ÙŠ Ø­Ù…Ù‰ ÙˆØ£Ø¹Ø±Ø§Ø¶ Ø¨Ø±Ø¯">
                                        <i class="fas fa-thermometer-half d-block mb-2"></i>
                                        <small>Ø­Ù…Ù‰</small>
                                    </button>
                                </div>
                                <div class="col-md-3 col-6">
                                    <button class="btn btn-outline-primary w-100 quick-action-btn" data-message="Ø£Ø¹Ù…Ù„ Ø¥ÙŠÙ‡ Ù„Ùˆ Ø­Ø¯ Ø§ØºÙ…Ù‰ Ø¹Ù„ÙŠÙ‡ØŸ">
                                        <i class="fas fa-dizzy d-block mb-2"></i>
                                        <small>Ø¥ØºÙ…Ø§Ø¡</small>
                                    </button>
                                </div>
                                <div class="col-md-3 col-6">
                                    <button class="btn btn-outline-primary w-100 quick-action-btn" data-message="Ø¥Ø²Ø§ÙŠ Ø£ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø­Ø±ÙˆÙ‚ØŸ">
                                        <i class="fas fa-fire d-block mb-2"></i>
                                        <small>Ø­Ø±ÙˆÙ‚</small>
                                    </button>
                                </div>
                            </div>

                            <!-- Nutrition Quick Buttons -->
                            <div class="mt-4">
                                <h6 class="text-muted mb-3">ğŸ¥— Ø§Ù„Ø£Ù†Ø¸Ù…Ø© Ø§Ù„ØºØ°Ø§Ø¦ÙŠØ©</h6>
                                <div class="row g-2">
                                    <div class="col-md-4 col-6">
                                        <button class="btn btn-outline-success w-100 quick-action-btn" data-message="Ù†Ø¸Ø§Ù… ØºØ°Ø§Ø¦ÙŠ Ù„Ù„Ø³ÙƒØ±ÙŠ">
                                            <i class="fas fa-apple-alt d-block mb-1"></i>
                                            <small>Ù†Ø¸Ø§Ù… Ø§Ù„Ø³ÙƒØ±ÙŠ</small>
                                        </button>
                                    </div>
                                    <div class="col-md-4 col-6">
                                        <button class="btn btn-outline-success w-100 quick-action-btn" data-message="Ù†Ø¸Ø§Ù… ØºØ°Ø§Ø¦ÙŠ Ù„Ø¶ØºØ· Ø§Ù„Ø¯Ù…">
                                            <i class="fas fa-heart d-block mb-1"></i>
                                            <small>Ù†Ø¸Ø§Ù… Ø¶ØºØ· Ø§Ù„Ø¯Ù…</small>
                                        </button>
                                    </div>
                                    <div class="col-md-4 col-6">
                                        <button class="btn btn-outline-success w-100 quick-action-btn" data-message="Ù†Ø¸Ø§Ù… ØºØ°Ø§Ø¦ÙŠ Ù„Ø¥Ù†Ù‚Ø§Øµ Ø§Ù„ÙˆØ²Ù†">
                                            <i class="fas fa-weight d-block mb-1"></i>
                                            <small>Ø¥Ù†Ù‚Ø§Øµ Ø§Ù„ÙˆØ²Ù†</small>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Chat Messages Area -->
                        <div class="chat-messages p-4" id="chatMessages" style="min-height: 400px; max-height: 500px; overflow-y: auto;">
                            <!-- Messages will be added here dynamically -->
                        </div>

                        <!-- Typing Indicator -->
                        <div class="typing-indicator px-4 pb-3" id="typingIndicator" style="display: none;">
                            <div class="d-flex align-items-center text-muted">
                                <div class="typing-dots me-2">
                                    <span></span>
                                    <span></span>
                                    <span></span>
                                </div>
                                <small>Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø·Ø¨ÙŠ ÙŠÙƒØªØ¨...</small>
                            </div>
                        </div>

                        <!-- Chat Input -->
                        <div class="chat-input border-top p-4">
                            <div class="input-group">
                                <textarea
                                    class="form-control border-0 shadow-none"
                                    id="messageInput"
                                    placeholder="Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ùƒ Ø§Ù„Ø·Ø¨ÙŠ Ù‡Ù†Ø§... (Ù…Ø«Ø§Ù„: Ø¹Ù†Ø¯ÙŠ ØµØ¯Ø§Ø¹ Ø´Ø¯ÙŠØ¯)"
                                    rows="1"
                                    style="resize: none; max-height: 120px;"
                                ></textarea>
                                <button class="btn btn-primary px-4" id="sendBtn" disabled>
                                    <i class="fas fa-paper-plane"></i>
                                </button>
                            </div>
                            <div class="mt-2">
                                <small class="text-muted">
                                    <i class="fas fa-exclamation-triangle me-1"></i>
                                    Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ù„Ø§ ÙŠØºÙ†ÙŠ Ø¹Ù† Ø§Ø³ØªØ´Ø§Ø±Ø© Ø§Ù„Ø·Ø¨ÙŠØ¨ Ø§Ù„Ù…Ø®ØªØµ
                                </small>
                            </div>
                        </div>
                    </div>

                    <!-- Tips Card -->
                    <div class="card border-0 shadow-sm rounded-4 mt-4">
                        <div class="card-body p-4">
                            <h5 class="text-primary fw-bold mb-3">
                                <i class="fas fa-lightbulb me-2"></i>
                                Ù†ØµØ§Ø¦Ø­ Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø£ÙØ¶Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø©:
                            </h5>
                            <div class="row">
                                <div class="col-md-6">
                                    <ul class="list-unstyled">
                                        <li class="mb-2"><i class="fas fa-check text-success me-2"></i>ÙƒÙ† Ù…Ø­Ø¯Ø¯Ø§Ù‹ ÙÙŠ ÙˆØµÙ Ø£Ø¹Ø±Ø§Ø¶Ùƒ</li>
                                        <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Ø§Ø°ÙƒØ± Ù…ØªÙ‰ Ø¨Ø¯Ø£Øª Ø§Ù„Ø£Ø¹Ø±Ø§Ø¶</li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <ul class="list-unstyled">
                                        <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Ø§Ø°ÙƒØ± Ø£ÙŠ ØªØ§Ø±ÙŠØ® Ø·Ø¨ÙŠ Ø°ÙŠ ØµÙ„Ø©</li>
                                        <li class="mb-2"><i class="fas fa-check text-success me-2"></i>ØµÙ Ø´Ø¯Ø© Ø§Ù„Ø£Ø¹Ø±Ø§Ø¶</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Emergency Modal -->
    <div class="modal fade" id="emergencyModal" tabindex="-1" aria-labelledby="emergencyModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header bg-danger text-white">
                    <h5 class="modal-title" id="emergencyModalLabel">
                        <i class="fas fa-ambulance me-2"></i>
                        Ø­Ø§Ù„Ø© Ø·ÙˆØ§Ø±Ø¦ØŸ
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p class="mb-3">Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù‡Ø°Ù‡ Ø­Ø§Ù„Ø© Ø·ÙˆØ§Ø±Ø¦ Ø·Ø¨ÙŠØ©ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§ØªØµØ§Ù„ ÙÙˆØ±Ø§Ù‹ Ø¨Ù€:</p>
                    <div class="row g-3">
                        <div class="col-6">
                            <div class="d-flex align-items-center p-3 bg-light rounded">
                                <i class="fas fa-phone text-danger fs-4 me-3"></i>
                                <div>
                                    <strong>Ø§Ù„Ø¥Ø³Ø¹Ø§Ù</strong>
                                    <div class="text-danger fw-bold">123</div>
                                </div>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="d-flex align-items-center p-3 bg-light rounded">
                                <i class="fas fa-hospital text-danger fs-4 me-3"></i>
                                <div>
                                    <strong>Ø§Ù„Ø·ÙˆØ§Ø±Ø¦</strong>
                                    <div class="text-danger fw-bold">16123</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©</button>
                </div>
            </div>
        </div>
    </div>
    


    <!-- Bootstrap JS Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Common Functions -->
    <script src="js/common.js"></script>
    <!-- Arabic Localization -->
    <script src="js/arabic-localization.js"></script>
    <!-- Custom JS -->
    <script src="js/main-bootstrap.js"></script>
    <script>
        // Medical Chatbot JavaScript
        document.addEventListener('DOMContentLoaded', function() {
            // DOM Elements
            const chatMessages = document.getElementById('chatMessages');
            const messageInput = document.getElementById('messageInput');
            const sendBtn = document.getElementById('sendBtn');
            const welcomeSection = document.getElementById('welcomeSection');
            const typingIndicator = document.getElementById('typingIndicator');
            const clearChatBtn = document.getElementById('clearChatBtn');
            const exportChatBtn = document.getElementById('exportChatBtn');
            const emergencyModal = new bootstrap.Modal(document.getElementById('emergencyModal'));

            // Chat state
            let chatHistory = [];
            let isTyping = false;

            // Emergency keywords that trigger the emergency modal
            const emergencyKeywords = [
                'Ø·ÙˆØ§Ø±Ø¦', 'emergency', 'Ù†Ø²ÙŠÙ', 'bleeding', 'Ø§Ø®ØªÙ†Ø§Ù‚', 'choking',
                'ØªÙˆÙ‚Ù Ø§Ù„Ù‚Ù„Ø¨', 'cardiac arrest', 'ÙÙ‚Ø¯Ø§Ù† Ø§Ù„ÙˆØ¹ÙŠ', 'unconscious',
                'Ø­Ø§Ø¯Ø«', 'accident', 'Ø³ÙƒØªØ©', 'stroke', 'Ù†ÙˆØ¨Ø© Ù‚Ù„Ø¨ÙŠØ©', 'heart attack',
                'ØªØ³Ù…Ù…', 'poisoning', 'Ø­Ø±ÙŠÙ‚', 'fire', 'ØºØ±Ù‚', 'drowning'
            ];

            // Initialize event listeners
            initializeEventListeners();
            loadChatHistory();
            adjustTextareaHeight();

            function initializeEventListeners() {
                // Send message events
                sendBtn.addEventListener('click', sendMessage);
                messageInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        sendMessage();
                    }
                });

                // Input validation
                messageInput.addEventListener('input', function() {
                    const hasText = this.value.trim().length > 0;
                    sendBtn.disabled = !hasText;
                    adjustTextareaHeight();

                    // Check for emergency keywords
                    if (hasText && containsEmergencyKeyword(this.value)) {
                        emergencyModal.show();
                    }
                });

                // Quick action buttons
                document.querySelectorAll('.quick-action-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const message = this.getAttribute('data-message');
                        messageInput.value = message;
                        sendBtn.disabled = false;

                        // Add visual feedback
                        this.style.transform = 'scale(0.95)';
                        setTimeout(() => {
                            this.style.transform = 'scale(1)';
                        }, 150);

                        // Send message after a short delay for better UX
                        setTimeout(() => {
                            sendMessage();
                        }, 200);
                    });
                });

                // Clear chat
                clearChatBtn.addEventListener('click', clearChat);

                // Export chat
                exportChatBtn.addEventListener('click', exportChat);
            }

            // Send message function
            async function sendMessage() {
                const message = messageInput.value.trim();
                if (!message || isTyping) return;

                // Check if user is logged in
                const userData = localStorage.getItem('currentUser');

                // Add user message to chat
                addMessage(message, 'user');
                messageInput.value = '';
                sendBtn.disabled = true;
                adjustTextareaHeight();

                // Hide welcome message
                if (welcomeSection) {
                    welcomeSection.style.display = 'none';
                }

                // Show typing indicator
                showTypingIndicator();

                try {
                    // Simulate AI response with local processing
                    let botResponse = await generateLocalResponse(message);

                    // Add login reminder for non-logged users occasionally
                    if (!userData && Math.random() < 0.3) {
                        botResponse += "\n\nğŸ’¡ **Ù†ØµÙŠØ­Ø©:** Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„Ùƒ Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ØªØ¬Ø±Ø¨Ø© Ø£ÙØ¶Ù„ ÙˆØ­ÙØ¸ ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª!";
                    }

                    // Hide typing indicator
                    hideTypingIndicator();

                    // Add bot response
                    addMessage(botResponse, 'bot');

                } catch (error) {
                    console.error('Error:', error);
                    hideTypingIndicator();

                    // Add error message
                    addMessage('Ø¹Ø°Ø±Ø§Ù‹ØŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.', 'bot', true);
                }

                // Save chat history (only if logged in)
                if (userData) {
                    saveChatHistory();
                }
            }

            // Generate local AI response
            async function generateLocalResponse(message) {
                // Simulate thinking time
                await new Promise(resolve => setTimeout(resolve, 1000 + Math.random() * 2000));

                const messageLower = message.toLowerCase();

                // Emergency responses
                if (containsEmergencyKeyword(message)) {
                    return "ğŸš¨ **Ù‡Ø°Ù‡ Ø­Ø§Ù„Ø© Ø·ÙˆØ§Ø±Ø¦!**\n\nÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§ØªØµØ§Ù„ ÙÙˆØ±Ø§Ù‹ Ø¨Ù€:\nâ€¢ Ø§Ù„Ø¥Ø³Ø¹Ø§Ù: 123\nâ€¢ Ø§Ù„Ø·ÙˆØ§Ø±Ø¦: 16123\n\nØ¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø´Ø®Øµ ÙØ§Ù‚Ø¯ Ø§Ù„ÙˆØ¹ÙŠ Ø£Ùˆ Ù„Ø§ ÙŠØªÙ†ÙØ³ØŒ Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¥Ù†Ø¹Ø§Ø´ Ø§Ù„Ù‚Ù„Ø¨ÙŠ Ø§Ù„Ø±Ø¦ÙˆÙŠ (CPR) ÙÙˆØ±Ø§Ù‹.\n\nâš ï¸ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ù„Ø§ ÙŠØºÙ†ÙŠ Ø¹Ù† Ø§Ù„Ø±Ø¹Ø§ÙŠØ© Ø§Ù„Ø·Ø¨ÙŠØ© Ø§Ù„ÙÙˆØ±ÙŠØ© ÙÙŠ Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø·ÙˆØ§Ø±Ø¦.";
                }

                // First aid responses
                const firstAidResponse = getFirstAidResponse(messageLower);
                if (firstAidResponse) {
                    return firstAidResponse;
                }

                // Common symptoms responses
                if (messageLower.includes('ØµØ¯Ø§Ø¹') || messageLower.includes('ÙˆØ¬Ø¹ Ø±Ø§Ø³')) {
                    return "ğŸ¤• **Ø¨Ø®ØµÙˆØµ Ø§Ù„ØµØ¯Ø§Ø¹:**\n\n**Ø£Ø³Ø¨Ø§Ø¨ Ù…Ø­ØªÙ…Ù„Ø©:**\nâ€¢ Ø§Ù„ØªÙˆØªØ± ÙˆØ§Ù„Ø¥Ø¬Ù‡Ø§Ø¯\nâ€¢ Ù‚Ù„Ø© Ø§Ù„Ù†ÙˆÙ…\nâ€¢ Ø§Ù„Ø¬ÙØ§Ù\nâ€¢ Ù…Ø´Ø§ÙƒÙ„ ÙÙŠ Ø§Ù„Ù†Ø¸Ø±\nâ€¢ ØªØºÙŠØ±Ø§Øª Ù‡Ø±Ù…ÙˆÙ†ÙŠØ©\n\n**Ù†ØµØ§Ø¦Ø­ Ù„Ù„ØªØ®ÙÙŠÙ:**\nâ€¢ Ø§Ø´Ø±Ø¨ ÙƒÙ…ÙŠØ© ÙƒØ§ÙÙŠØ© Ù…Ù† Ø§Ù„Ù…Ø§Ø¡\nâ€¢ Ø®Ø° Ù‚Ø³Ø· Ù…Ù† Ø§Ù„Ø±Ø§Ø­Ø©\nâ€¢ ØªØ¬Ù†Ø¨ Ø§Ù„Ø£Ø¶ÙˆØ§Ø¡ Ø§Ù„Ø³Ø§Ø·Ø¹Ø©\nâ€¢ Ø¯Ù„Ùƒ Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø±Ù‚Ø¨Ø© ÙˆØ§Ù„ÙƒØªÙÙŠÙ†\nâ€¢ ØªÙ†Ø§ÙˆÙ„ Ù…Ø³ÙƒÙ† Ø®ÙÙŠÙ Ø¥Ø°Ø§ Ù„Ø²Ù… Ø§Ù„Ø£Ù…Ø±\n\nâš ï¸ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„ØµØ¯Ø§Ø¹ Ø´Ø¯ÙŠØ¯ Ø£Ùˆ Ù…ØµØ­ÙˆØ¨ Ø¨Ø­Ù…Ù‰ Ø£Ùˆ Ù‚ÙŠØ¡ØŒ ÙŠØ¬Ø¨ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø·Ø¨ÙŠØ¨ ÙÙˆØ±Ø§Ù‹.";
                }

                if (messageLower.includes('Ø­Ù…Ù‰') || messageLower.includes('Ø³Ø®ÙˆÙ†Ø©') || messageLower.includes('Ø­Ø±Ø§Ø±Ø©')) {
                    return "ğŸŒ¡ï¸ **Ø¨Ø®ØµÙˆØµ Ø§Ù„Ø­Ù…Ù‰:**\n\n**Ø§Ù„Ø­Ù…Ù‰ Ù‡ÙŠ Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ø·Ø¨ÙŠØ¹ÙŠØ© Ù„Ù„Ø¬Ø³Ù… Ù„Ù…Ø­Ø§Ø±Ø¨Ø© Ø§Ù„Ø¹Ø¯ÙˆÙ‰**\n\n**Ù†ØµØ§Ø¦Ø­ Ù„Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø­Ù…Ù‰:**\nâ€¢ Ø§Ø´Ø±Ø¨ Ø³ÙˆØ§Ø¦Ù„ ÙƒØ«ÙŠØ±Ø© (Ù…Ø§Ø¡ØŒ Ø¹ØµØ§Ø¦Ø± Ø·Ø¨ÙŠØ¹ÙŠØ©)\nâ€¢ Ø®Ø° Ø­Ù…Ø§Ù… ÙØ§ØªØ± (Ù„ÙŠØ³ Ø¨Ø§Ø±Ø¯)\nâ€¢ Ø§Ø±ØªØ¯ÙŠ Ù…Ù„Ø§Ø¨Ø³ Ø®ÙÙŠÙØ©\nâ€¢ Ø§Ø³ØªØ±Ø­ ÙÙŠ Ù…ÙƒØ§Ù† Ø¨Ø§Ø±Ø¯\nâ€¢ ØªÙ†Ø§ÙˆÙ„ Ø®Ø§ÙØ¶ Ø­Ø±Ø§Ø±Ø© Ù…Ù†Ø§Ø³Ø¨\n\n**Ù…ØªÙ‰ ØªØ±Ø§Ø¬Ø¹ Ø§Ù„Ø·Ø¨ÙŠØ¨:**\nâ€¢ Ø¥Ø°Ø§ ØªØ¬Ø§ÙˆØ²Øª Ø§Ù„Ø­Ø±Ø§Ø±Ø© 39Â°Ù…\nâ€¢ Ø¥Ø°Ø§ Ø§Ø³ØªÙ…Ø±Øª Ø£ÙƒØ«Ø± Ù…Ù† 3 Ø£ÙŠØ§Ù…\nâ€¢ Ø¥Ø°Ø§ ØµØ§Ø­Ø¨Ù‡Ø§ Ø£Ø¹Ø±Ø§Ø¶ Ø£Ø®Ø±Ù‰ Ù…Ù‚Ù„Ù‚Ø©\n\nâš ï¸ Ù‡Ø°Ø§ Ù„Ø§ ÙŠØºÙ†ÙŠ Ø¹Ù† Ø§Ø³ØªØ´Ø§Ø±Ø© Ø§Ù„Ø·Ø¨ÙŠØ¨ Ø§Ù„Ù…Ø®ØªØµ.";
                }

                if (messageLower.includes('Ø³Ø¹Ø§Ù„') || messageLower.includes('ÙƒØ­Ø©')) {
                    return "ğŸ˜· **Ø¨Ø®ØµÙˆØµ Ø§Ù„Ø³Ø¹Ø§Ù„:**\n\n**Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø³Ø¹Ø§Ù„:**\nâ€¢ **Ø¬Ø§Ù:** Ø¨Ø¯ÙˆÙ† Ø¨Ù„ØºÙ…\nâ€¢ **Ù…Ø¹ Ø¨Ù„ØºÙ…:** Ù‚Ø¯ ÙŠØ¯Ù„ Ø¹Ù„Ù‰ Ø¹Ø¯ÙˆÙ‰\n\n**Ù†ØµØ§Ø¦Ø­ Ù„Ù„ØªØ®ÙÙŠÙ:**\nâ€¢ Ø§Ø´Ø±Ø¨ Ø³ÙˆØ§Ø¦Ù„ Ø¯Ø§ÙØ¦Ø© (Ø´Ø§ÙŠ Ø¨Ø§Ù„Ø¹Ø³Ù„)\nâ€¢ Ø§Ø³ØªÙ†Ø´Ù‚ Ø¨Ø®Ø§Ø± Ø§Ù„Ù…Ø§Ø¡\nâ€¢ ØªØ¬Ù†Ø¨ Ø§Ù„Ù…Ù‡ÙŠØ¬Ø§Øª (Ø¯Ø®Ø§Ù†ØŒ Ø¹Ø·ÙˆØ±)\nâ€¢ Ø§Ø³ØªØ®Ø¯Ù… Ù…Ø±Ø·Ø¨ Ø§Ù„Ù‡ÙˆØ§Ø¡\nâ€¢ ØªÙ†Ø§ÙˆÙ„ Ù…Ù„Ø¹Ù‚Ø© Ø¹Ø³Ù„ Ù‚Ø¨Ù„ Ø§Ù„Ù†ÙˆÙ…\n\n**Ù…ØªÙ‰ ØªØ±Ø§Ø¬Ø¹ Ø§Ù„Ø·Ø¨ÙŠØ¨:**\nâ€¢ Ø¥Ø°Ø§ Ø§Ø³ØªÙ…Ø± Ø£ÙƒØ«Ø± Ù…Ù† Ø£Ø³Ø¨ÙˆØ¹ÙŠÙ†\nâ€¢ Ø¥Ø°Ø§ ØµØ§Ø­Ø¨Ù‡ Ø¯Ù… Ø£Ùˆ Ø­Ù…Ù‰\nâ€¢ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ØµØ­ÙˆØ¨ Ø¨Ø¶ÙŠÙ‚ ØªÙ†ÙØ³\n\nâš ï¸ Ù‡Ø°Ø§ Ù„Ø§ ÙŠØºÙ†ÙŠ Ø¹Ù† Ø§Ø³ØªØ´Ø§Ø±Ø© Ø§Ù„Ø·Ø¨ÙŠØ¨ Ø§Ù„Ù…Ø®ØªØµ.";
                }

                if (messageLower.includes('Ù…Ø¹Ø¯Ø©') || messageLower.includes('Ø¨Ø·Ù†') || messageLower.includes('Ù…ØºØµ')) {
                    return "ğŸ¤¢ **Ø¨Ø®ØµÙˆØµ Ø£Ù„Ù… Ø§Ù„Ù…Ø¹Ø¯Ø©:**\n\n**Ø£Ø³Ø¨Ø§Ø¨ Ù…Ø­ØªÙ…Ù„Ø©:**\nâ€¢ Ø¹Ø³Ø± Ø§Ù„Ù‡Ø¶Ù…\nâ€¢ Ø§Ù„ØªÙ‡Ø§Ø¨ Ø§Ù„Ù…Ø¹Ø¯Ø©\nâ€¢ Ø§Ù„Ù‚ÙˆÙ„ÙˆÙ† Ø§Ù„Ø¹ØµØ¨ÙŠ\nâ€¢ Ø§Ù„ØªØ³Ù…Ù… Ø§Ù„ØºØ°Ø§Ø¦ÙŠ\nâ€¢ Ø§Ù„Ù‚Ø±Ø­Ø©\n\n**Ù†ØµØ§Ø¦Ø­ Ù„Ù„ØªØ®ÙÙŠÙ:**\nâ€¢ ØªØ¬Ù†Ø¨ Ø§Ù„Ø£Ø·Ø¹Ù…Ø© Ø§Ù„Ø­Ø§Ø±Ø© ÙˆØ§Ù„Ø¯Ù‡Ù†ÙŠØ©\nâ€¢ Ø§Ø´Ø±Ø¨ Ø´Ø§ÙŠ Ø§Ù„Ù†Ø¹Ù†Ø§Ø¹ Ø£Ùˆ Ø§Ù„ÙƒØ§Ù…ÙˆÙ…ÙŠÙ„\nâ€¢ ØªÙ†Ø§ÙˆÙ„ ÙˆØ¬Ø¨Ø§Øª ØµØºÙŠØ±Ø© ÙˆÙ…ØªÙƒØ±Ø±Ø©\nâ€¢ ØªØ¬Ù†Ø¨ Ø§Ù„ØªÙˆØªØ±\nâ€¢ Ø¶Ø¹ ÙƒÙ…Ø§Ø¯Ø© Ø¯Ø§ÙØ¦Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ø·Ù†\n\n**Ù…ØªÙ‰ ØªØ±Ø§Ø¬Ø¹ Ø§Ù„Ø·Ø¨ÙŠØ¨:**\nâ€¢ Ø£Ù„Ù… Ø´Ø¯ÙŠØ¯ ÙˆÙ…Ø³ØªÙ…Ø±\nâ€¢ Ù‚ÙŠØ¡ Ù…Ø³ØªÙ…Ø± Ø£Ùˆ Ø¯Ù…\nâ€¢ Ø­Ù…Ù‰ Ù…Ø¹ Ø§Ù„Ø£Ù„Ù…\nâ€¢ ÙÙ‚Ø¯Ø§Ù† Ø§Ù„ÙˆØ²Ù† ØºÙŠØ± Ø§Ù„Ù…Ø¨Ø±Ø±\n\nâš ï¸ Ù‡Ø°Ø§ Ù„Ø§ ÙŠØºÙ†ÙŠ Ø¹Ù† Ø§Ø³ØªØ´Ø§Ø±Ø© Ø§Ù„Ø·Ø¨ÙŠØ¨ Ø§Ù„Ù…Ø®ØªØµ.";
                }

                if (messageLower.includes('Ø¶ØºØ·') || messageLower.includes('Ø¯ÙˆØ®Ø©') || messageLower.includes('Ø¯ÙˆØ§Ø±')) {
                    return "ğŸ’« **Ø¨Ø®ØµÙˆØµ Ø§Ù„Ø¯ÙˆØ®Ø© ÙˆØ¶ØºØ· Ø§Ù„Ø¯Ù…:**\n\n**Ø£Ø³Ø¨Ø§Ø¨ Ø§Ù„Ø¯ÙˆØ®Ø©:**\nâ€¢ Ø§Ù†Ø®ÙØ§Ø¶ Ø¶ØºØ· Ø§Ù„Ø¯Ù…\nâ€¢ Ø§Ù„Ø¬ÙØ§Ù\nâ€¢ Ø§Ù†Ø®ÙØ§Ø¶ Ø§Ù„Ø³ÙƒØ±\nâ€¢ Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„Ø£Ø°Ù† Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ©\nâ€¢ Ø§Ù„Ø£Ù†ÙŠÙ…ÙŠØ§\n\n**Ù†ØµØ§Ø¦Ø­ ÙÙˆØ±ÙŠØ©:**\nâ€¢ Ø§Ø¬Ù„Ø³ Ø£Ùˆ Ø§Ø³ØªÙ„Ù‚ ÙÙˆØ±Ø§Ù‹\nâ€¢ Ø§Ø´Ø±Ø¨ Ù…Ø§Ø¡ Ø£Ùˆ Ø¹ØµÙŠØ±\nâ€¢ ØªØ¬Ù†Ø¨ Ø§Ù„Ø­Ø±ÙƒØ© Ø§Ù„Ù…ÙØ§Ø¬Ø¦Ø©\nâ€¢ ØªÙ†ÙØ³ Ø¨Ø¹Ù…Ù‚\nâ€¢ ØªÙ†Ø§ÙˆÙ„ Ø´ÙŠØ¡ Ø­Ù„Ùˆ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø³ÙƒØ± Ù…Ù†Ø®ÙØ¶\n\n**Ù„Ù„ÙˆÙ‚Ø§ÙŠØ©:**\nâ€¢ Ø§Ø´Ø±Ø¨ Ø³ÙˆØ§Ø¦Ù„ ÙƒØ§ÙÙŠØ©\nâ€¢ Ù‚Ù… Ø¨Ø¨Ø·Ø¡ Ù…Ù† Ø§Ù„Ø¬Ù„ÙˆØ³ Ø£Ùˆ Ø§Ù„Ø§Ø³ØªÙ„Ù‚Ø§Ø¡\nâ€¢ ØªÙ†Ø§ÙˆÙ„ ÙˆØ¬Ø¨Ø§Øª Ù…Ù†ØªØ¸Ù…Ø©\nâ€¢ ØªØ¬Ù†Ø¨ Ø§Ù„ÙˆÙ‚ÙˆÙ Ù„ÙØªØ±Ø§Øª Ø·ÙˆÙŠÙ„Ø©\n\nâš ï¸ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø¯ÙˆØ®Ø© Ø´Ø¯ÙŠØ¯Ø© Ø£Ùˆ Ù…ØªÙƒØ±Ø±Ø©ØŒ Ø±Ø§Ø¬Ø¹ Ø§Ù„Ø·Ø¨ÙŠØ¨ ÙÙˆØ±Ø§Ù‹.";
                }

                if (messageLower.includes('Ù†ÙˆÙ…') || messageLower.includes('Ø£Ø±Ù‚') || messageLower.includes('Ø³Ù‡Ø±')) {
                    return "ğŸ˜´ **Ø¨Ø®ØµÙˆØµ Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„Ù†ÙˆÙ…:**\n\n**Ø£Ø³Ø¨Ø§Ø¨ Ø§Ù„Ø£Ø±Ù‚:**\nâ€¢ Ø§Ù„ØªÙˆØªØ± ÙˆØ§Ù„Ù‚Ù„Ù‚\nâ€¢ Ø§Ù„ÙƒØ§ÙÙŠÙŠÙ† Ø§Ù„Ù…ÙØ±Ø·\nâ€¢ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø´Ø§Ø´Ø§Øª Ù‚Ø¨Ù„ Ø§Ù„Ù†ÙˆÙ…\nâ€¢ Ø¹Ø¯Ù… Ø§Ù†ØªØ¸Ø§Ù… Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„Ù†ÙˆÙ…\nâ€¢ Ù…Ø´Ø§ÙƒÙ„ ØµØ­ÙŠØ©\n\n**Ù†ØµØ§Ø¦Ø­ Ù„Ù†ÙˆÙ… Ø£ÙØ¶Ù„:**\nâ€¢ Ø­Ø¯Ø¯ Ù…ÙˆØ¹Ø¯ Ø«Ø§Ø¨Øª Ù„Ù„Ù†ÙˆÙ… ÙˆØ§Ù„Ø§Ø³ØªÙŠÙ‚Ø§Ø¸\nâ€¢ ØªØ¬Ù†Ø¨ Ø§Ù„ÙƒØ§ÙÙŠÙŠÙ† Ø¨Ø¹Ø¯ Ø§Ù„Ø¹ØµØ±\nâ€¢ Ø§Ø¬Ø¹Ù„ Ø§Ù„ØºØ±ÙØ© Ù…Ø¸Ù„Ù…Ø© ÙˆØ¨Ø§Ø±Ø¯Ø©\nâ€¢ ØªØ¬Ù†Ø¨ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ù‚Ø¨Ù„ Ø§Ù„Ù†ÙˆÙ… Ø¨Ø³Ø§Ø¹Ø©\nâ€¢ Ù…Ø§Ø±Ø³ Ø§Ù„Ø§Ø³ØªØ±Ø®Ø§Ø¡ Ø£Ùˆ Ø§Ù„ØªØ£Ù…Ù„\nâ€¢ ØªØ¬Ù†Ø¨ Ø§Ù„ÙˆØ¬Ø¨Ø§Øª Ø§Ù„Ø«Ù‚ÙŠÙ„Ø© Ù‚Ø¨Ù„ Ø§Ù„Ù†ÙˆÙ…\n\n**Ù…ØªÙ‰ ØªØ±Ø§Ø¬Ø¹ Ø§Ù„Ø·Ø¨ÙŠØ¨:**\nâ€¢ Ø£Ø±Ù‚ Ù…Ø³ØªÙ…Ø± Ø£ÙƒØ«Ø± Ù…Ù† Ø£Ø³Ø¨ÙˆØ¹ÙŠÙ†\nâ€¢ Ø´Ø®ÙŠØ± Ø´Ø¯ÙŠØ¯ Ø£Ùˆ ØªÙˆÙ‚Ù Ø§Ù„ØªÙ†ÙØ³\nâ€¢ Ù†Ø¹Ø§Ø³ Ù…ÙØ±Ø· Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ù†Ù‡Ø§Ø±\n\nâš ï¸ Ø§Ù„Ù†ÙˆÙ… Ø§Ù„Ø¬ÙŠØ¯ Ø¶Ø±ÙˆØ±ÙŠ Ù„Ù„ØµØ­Ø© Ø§Ù„Ø¹Ø§Ù…Ø©.";
                }

                if (messageLower.includes('Ø³ÙƒØ±') || messageLower.includes('Ø³ÙƒØ±ÙŠ') || messageLower.includes('diabetes')) {
                    return "ğŸ¯ **Ø¨Ø®ØµÙˆØµ Ø§Ù„Ø³ÙƒØ±ÙŠ:**\n\n**Ø£Ø¹Ø±Ø§Ø¶ Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„Ø³ÙƒØ±:**\nâ€¢ Ø¹Ø·Ø´ Ø´Ø¯ÙŠØ¯\nâ€¢ ÙƒØ«Ø±Ø© Ø§Ù„ØªØ¨ÙˆÙ„\nâ€¢ ØªØ¹Ø¨ ÙˆØ¥Ø±Ù‡Ø§Ù‚\nâ€¢ ØªØ´ÙˆØ´ Ø§Ù„Ø±Ø¤ÙŠØ©\nâ€¢ Ø¨Ø·Ø¡ Ø´ÙØ§Ø¡ Ø§Ù„Ø¬Ø±ÙˆØ­\n\n**Ø£Ø¹Ø±Ø§Ø¶ Ø§Ù†Ø®ÙØ§Ø¶ Ø§Ù„Ø³ÙƒØ±:**\nâ€¢ Ø¯ÙˆØ®Ø© ÙˆØ±Ø¹Ø´Ø©\nâ€¢ ØªØ¹Ø±Ù‚\nâ€¢ Ø¬ÙˆØ¹ Ø´Ø¯ÙŠØ¯\nâ€¢ ØªØ´ÙˆØ´ Ø°Ù‡Ù†ÙŠ\nâ€¢ Ø®ÙÙ‚Ø§Ù† Ø§Ù„Ù‚Ù„Ø¨\n\n**Ù†ØµØ§Ø¦Ø­ Ù„Ù„ØªØ­ÙƒÙ…:**\nâ€¢ Ø§ØªØ¨Ø¹ Ù†Ø¸Ø§Ù… ØºØ°Ø§Ø¦ÙŠ Ù…ØªÙˆØ§Ø²Ù†\nâ€¢ Ù…Ø§Ø±Ø³ Ø§Ù„Ø±ÙŠØ§Ø¶Ø© Ø¨Ø§Ù†ØªØ¸Ø§Ù…\nâ€¢ Ø±Ø§Ù‚Ø¨ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø³ÙƒØ±\nâ€¢ ØªÙ†Ø§ÙˆÙ„ Ø§Ù„Ø£Ø¯ÙˆÙŠØ© ÙÙŠ Ù…ÙˆØ§Ø¹ÙŠØ¯Ù‡Ø§\nâ€¢ ØªØ¬Ù†Ø¨ Ø§Ù„Ø³ÙƒØ±ÙŠØ§Øª Ø§Ù„Ø¨Ø³ÙŠØ·Ø©\n\n**ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„Ø·ÙˆØ§Ø±Ø¦:**\nâ€¢ Ø§Ù†Ø®ÙØ§Ø¶ Ø´Ø¯ÙŠØ¯: ØªÙ†Ø§ÙˆÙ„ Ø³ÙƒØ± Ø£Ùˆ Ø¹ØµÙŠØ± ÙÙˆØ±Ø§Ù‹\nâ€¢ Ø§Ø±ØªÙØ§Ø¹ Ø´Ø¯ÙŠØ¯: Ø§Ø´Ø±Ø¨ Ù…Ø§Ø¡ ÙˆØ§ØªØµÙ„ Ø¨Ø§Ù„Ø·Ø¨ÙŠØ¨\n\nâš ï¸ Ø§Ù„Ø³ÙƒØ±ÙŠ ÙŠØ­ØªØ§Ø¬ Ù…ØªØ§Ø¨Ø¹Ø© Ø·Ø¨ÙŠØ© Ø¯ÙˆØ±ÙŠØ©.";
                }

                // Ø§Ù„Ø£Ù†Ø¸Ù…Ø© Ø§Ù„ØºØ°Ø§Ø¦ÙŠØ©
                if (messageLower.includes('Ù†Ø¸Ø§Ù… ØºØ°Ø§Ø¦ÙŠ') || messageLower.includes('Ø±ÙŠØ¬ÙŠÙ…') || messageLower.includes('Ø­Ù…ÙŠØ©') ||
                    messageLower.includes('Ù†Ø¸Ø§Ù… Ø§Ù„Ø³ÙƒØ±ÙŠ') || messageLower.includes('Ø¶ØºØ· Ø§Ù„Ø¯Ù…') || messageLower.includes('Ø¥Ù†Ù‚Ø§Øµ Ø§Ù„ÙˆØ²Ù†')) {
                    console.log('Nutrition plan condition matched for:', messageLower);
                    return generateNutritionPlan(messageLower);
                }

                // General health questions
                if (messageLower.includes('Ù†ØµØ§Ø¦Ø­') || messageLower.includes('ØµØ­Ø©') || messageLower.includes('ÙˆÙ‚Ø§ÙŠØ©')) {
                    return "ğŸŒŸ **Ù†ØµØ§Ø¦Ø­ ØµØ­ÙŠØ© Ø¹Ø§Ù…Ø©:**\n\n**Ù„Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ ØµØ­Ø© Ø¬ÙŠØ¯Ø©:**\nâ€¢ Ø§Ø´Ø±Ø¨ 8 Ø£ÙƒÙˆØ§Ø¨ Ù…Ø§Ø¡ ÙŠÙˆÙ…ÙŠØ§Ù‹\nâ€¢ ØªÙ†Ø§ÙˆÙ„ 5 Ø­ØµØµ Ù…Ù† Ø§Ù„Ø®Ø¶Ø§Ø± ÙˆØ§Ù„ÙÙˆØ§ÙƒÙ‡\nâ€¢ Ù…Ø§Ø±Ø³ Ø§Ù„Ø±ÙŠØ§Ø¶Ø© 30 Ø¯Ù‚ÙŠÙ‚Ø© ÙŠÙˆÙ…ÙŠØ§Ù‹\nâ€¢ Ù†Ù… 7-8 Ø³Ø§Ø¹Ø§Øª Ù„ÙŠÙ„Ø§Ù‹\nâ€¢ ØªØ¬Ù†Ø¨ Ø§Ù„ØªØ¯Ø®ÙŠÙ† ÙˆØ§Ù„ÙƒØ­ÙˆÙ„\nâ€¢ Ø§ØºØ³Ù„ ÙŠØ¯ÙŠÙƒ Ø¨Ø§Ù†ØªØ¸Ø§Ù…\nâ€¢ ØªØ¬Ù†Ø¨ Ø§Ù„ØªÙˆØªØ± ÙˆØ§Ù„Ø¶ØºØ· Ø§Ù„Ù†ÙØ³ÙŠ\nâ€¢ Ø±Ø§Ø¬Ø¹ Ø§Ù„Ø·Ø¨ÙŠØ¨ Ø¯ÙˆØ±ÙŠØ§Ù‹ Ù„Ù„ÙØ­Øµ\n\n**Ù„Ù„ÙˆÙ‚Ø§ÙŠØ© Ù…Ù† Ø§Ù„Ø£Ù…Ø±Ø§Ø¶:**\nâ€¢ ØªÙ†Ø§ÙˆÙ„ Ø·Ø¹Ø§Ù… Ù…ØªÙˆØ§Ø²Ù†\nâ€¢ Ø­Ø§ÙØ¸ Ø¹Ù„Ù‰ ÙˆØ²Ù† ØµØ­ÙŠ\nâ€¢ ØªØ¬Ù†Ø¨ Ø§Ù„Ø£Ø·Ø¹Ù…Ø© Ø§Ù„Ù…ØµÙ†Ø¹Ø©\nâ€¢ Ù…Ø§Ø±Ø³ Ø§Ù„ØªØ£Ù…Ù„ Ø£Ùˆ Ø§Ù„ÙŠÙˆØ¬Ø§\n\nâš ï¸ Ù‡Ø°Ù‡ Ù†ØµØ§Ø¦Ø­ Ø¹Ø§Ù…Ø© ÙˆÙ„Ø§ ØªØºÙ†ÙŠ Ø¹Ù† Ø§Ø³ØªØ´Ø§Ø±Ø© Ø§Ù„Ø·Ø¨ÙŠØ¨ Ø§Ù„Ù…Ø®ØªØµ.";
                }

                // Check for specific medical questions
                if (messageLower.includes('Ø¯ÙƒØªÙˆØ±') || messageLower.includes('Ø·Ø¨ÙŠØ¨') || messageLower.includes('Ù…Ø³ØªØ´ÙÙ‰')) {
                    return "ğŸ‘¨â€âš•ï¸ **Ø¨Ø®ØµÙˆØµ Ø§Ù„Ø§Ø³ØªØ´Ø§Ø±Ø© Ø§Ù„Ø·Ø¨ÙŠØ©:**\n\nØ£Ù†Ø§ Ù…Ø³Ø§Ø¹Ø¯ Ø°ÙƒÙŠ ÙŠÙ‚Ø¯Ù… Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø·Ø¨ÙŠØ© Ø¹Ø§Ù…Ø©ØŒ Ù„ÙƒÙ† Ù„Ø§ Ø£ØºÙ†ÙŠ Ø¹Ù†:\n\n**Ù…ØªÙ‰ ØªØ­ØªØ§Ø¬ Ø·Ø¨ÙŠØ¨:**\nâ€¢ Ø£Ø¹Ø±Ø§Ø¶ Ø´Ø¯ÙŠØ¯Ø© Ø£Ùˆ Ù…Ø³ØªÙ…Ø±Ø©\nâ€¢ Ø­Ø§Ù„Ø§Øª Ø·ÙˆØ§Ø±Ø¦\nâ€¢ ØªØ´Ø®ÙŠØµ Ø¯Ù‚ÙŠÙ‚\nâ€¢ ÙˆØµÙ Ø£Ø¯ÙˆÙŠØ©\nâ€¢ ÙØ­ÙˆØµØ§Øª Ø·Ø¨ÙŠØ©\n\n**ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ ÙÙŠ:**\nâ€¢ ÙÙ‡Ù… Ø§Ù„Ø£Ø¹Ø±Ø§Ø¶ Ø§Ù„Ø¹Ø§Ù…Ø©\nâ€¢ Ø§Ù„Ø¥Ø³Ø¹Ø§ÙØ§Øª Ø§Ù„Ø£ÙˆÙ„ÙŠØ©\nâ€¢ Ø§Ù„Ù†ØµØ§Ø¦Ø­ Ø§Ù„ØµØ­ÙŠØ©\nâ€¢ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¹Ù† Ø§Ù„Ø£Ù…Ø±Ø§Ø¶ Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©\n\n**Ù„Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø·Ø¨ÙŠØ¨:**\nâ€¢ Ø§Ø³ØªØ®Ø¯Ù… Ø®Ø¯Ù…Ø© Ø­Ø¬Ø² Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯ ÙÙŠ Ø§Ù„Ù…ÙˆÙ‚Ø¹\nâ€¢ Ø§ØªØµÙ„ Ø¨Ø£Ù‚Ø±Ø¨ Ù…Ø³ØªØ´ÙÙ‰\nâ€¢ Ø±Ø§Ø¬Ø¹ Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø£Ø·Ø¨Ø§Ø¡ Ø§Ù„Ù…Ø­Ù„ÙŠÙŠÙ†\n\nâš ï¸ ÙÙŠ Ø§Ù„Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø·Ø§Ø±Ø¦Ø©ØŒ Ø§ØªØµÙ„ Ø¨Ø§Ù„Ø¥Ø³Ø¹Ø§Ù ÙÙˆØ±Ø§Ù‹: 123";
                }

                if (messageLower.includes('Ø¯ÙˆØ§Ø¡') || messageLower.includes('Ø¹Ù„Ø§Ø¬') || messageLower.includes('Ø­Ø¨ÙˆØ¨')) {
                    return "ğŸ’Š **Ø¨Ø®ØµÙˆØµ Ø§Ù„Ø£Ø¯ÙˆÙŠØ©:**\n\nâš ï¸ **ØªØ­Ø°ÙŠØ± Ù…Ù‡Ù…:** Ù„Ø§ ÙŠÙ…ÙƒÙ†Ù†ÙŠ ÙˆØµÙ Ø£Ø¯ÙˆÙŠØ© Ø£Ùˆ ØªØºÙŠÙŠØ± Ø¬Ø±Ø¹Ø§Øª.\n\n**Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¹Ø§Ù…Ø© Ø¹Ù† Ø§Ù„Ø£Ø¯ÙˆÙŠØ©:**\nâ€¢ Ø§ØªØ¨Ø¹ ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ø·Ø¨ÙŠØ¨ Ø¯Ø§Ø¦Ù…Ø§Ù‹\nâ€¢ Ù„Ø§ ØªØªÙˆÙ‚Ù Ø¹Ù† Ø§Ù„Ø¯ÙˆØ§Ø¡ ÙØ¬Ø£Ø©\nâ€¢ Ø§Ù‚Ø±Ø£ Ø§Ù„Ù†Ø´Ø±Ø© Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ©\nâ€¢ Ø§Ø­ÙØ¸ Ø§Ù„Ø£Ø¯ÙˆÙŠØ© ÙÙŠ Ù…ÙƒØ§Ù† Ø¢Ù…Ù†\nâ€¢ ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡\n\n**Ø¢Ø«Ø§Ø± Ø¬Ø§Ù†Ø¨ÙŠØ© Ø´Ø§Ø¦Ø¹Ø©:**\nâ€¢ ØºØ«ÙŠØ§Ù† Ø£Ùˆ Ø¯ÙˆØ®Ø©\nâ€¢ Ø·ÙØ­ Ø¬Ù„Ø¯ÙŠ\nâ€¢ Ø§Ø¶Ø·Ø±Ø§Ø¨ Ø§Ù„Ù…Ø¹Ø¯Ø©\nâ€¢ Ù†Ø¹Ø§Ø³ Ø£Ùˆ Ø£Ø±Ù‚\n\n**Ù…ØªÙ‰ ØªØªØµÙ„ Ø¨Ø§Ù„Ø·Ø¨ÙŠØ¨:**\nâ€¢ Ø¢Ø«Ø§Ø± Ø¬Ø§Ù†Ø¨ÙŠØ© Ø´Ø¯ÙŠØ¯Ø©\nâ€¢ Ø­Ø³Ø§Ø³ÙŠØ© (Ø·ÙØ­ØŒ ØªÙˆØ±Ù…ØŒ ØµØ¹ÙˆØ¨Ø© ØªÙ†ÙØ³)\nâ€¢ Ø¹Ø¯Ù… ØªØ­Ø³Ù† Ø§Ù„Ø£Ø¹Ø±Ø§Ø¶\nâ€¢ ØªÙØ§Ø¹Ù„ Ù…Ø¹ Ø£Ø¯ÙˆÙŠØ© Ø£Ø®Ø±Ù‰\n\nâš ï¸ Ø§Ø³ØªØ´Ø± Ø§Ù„Ø·Ø¨ÙŠØ¨ Ø£Ùˆ Ø§Ù„ØµÙŠØ¯Ù„ÙŠ Ù‚Ø¨Ù„ ØªÙ†Ø§ÙˆÙ„ Ø£ÙŠ Ø¯ÙˆØ§Ø¡.";
                }

                if (messageLower.includes('ÙƒÙˆØ±ÙˆÙ†Ø§') || messageLower.includes('covid') || messageLower.includes('ÙÙŠØ±ÙˆØ³')) {
                    return "ğŸ¦  **Ø¨Ø®ØµÙˆØµ ÙƒÙˆÙÙŠØ¯-19 ÙˆØ§Ù„ÙÙŠØ±ÙˆØ³Ø§Øª:**\n\n**Ø£Ø¹Ø±Ø§Ø¶ ÙƒÙˆÙÙŠØ¯-19:**\nâ€¢ Ø­Ù…Ù‰ ÙˆØ³Ø¹Ø§Ù„ Ø¬Ø§Ù\nâ€¢ ÙÙ‚Ø¯Ø§Ù† Ø­Ø§Ø³Ø© Ø§Ù„Ø´Ù… Ø£Ùˆ Ø§Ù„ØªØ°ÙˆÙ‚\nâ€¢ ØªØ¹Ø¨ ÙˆØ¢Ù„Ø§Ù… Ø¹Ø¶Ù„Ø§Øª\nâ€¢ Ø¶ÙŠÙ‚ ØªÙ†ÙØ³\nâ€¢ Ø§Ù„ØªÙ‡Ø§Ø¨ Ø­Ù„Ù‚\n\n**Ø§Ù„ÙˆÙ‚Ø§ÙŠØ©:**\nâ€¢ Ø§ØºØ³Ù„ ÙŠØ¯ÙŠÙƒ Ø¨Ø§Ù†ØªØ¸Ø§Ù…\nâ€¢ Ø§Ø±ØªØ¯ÙŠ Ø§Ù„ÙƒÙ…Ø§Ù…Ø© ÙÙŠ Ø§Ù„Ø£Ù…Ø§ÙƒÙ† Ø§Ù„Ù…Ø²Ø¯Ø­Ù…Ø©\nâ€¢ Ø­Ø§ÙØ¸ Ø¹Ù„Ù‰ Ø§Ù„ØªØ¨Ø§Ø¹Ø¯ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ\nâ€¢ ØªØ¬Ù†Ø¨ Ù„Ù…Ø³ Ø§Ù„ÙˆØ¬Ù‡\nâ€¢ Ù†Ø¸Ù Ø§Ù„Ø£Ø³Ø·Ø­ Ø¨Ø§Ù†ØªØ¸Ø§Ù…\n\n**Ø¥Ø°Ø§ ÙƒÙ†Øª Ù…ØµØ§Ø¨Ø§Ù‹:**\nâ€¢ Ø§Ø¨Ù‚ ÙÙŠ Ø§Ù„Ù…Ù†Ø²Ù„\nâ€¢ Ø§Ø´Ø±Ø¨ Ø³ÙˆØ§Ø¦Ù„ ÙƒØ«ÙŠØ±Ø©\nâ€¢ Ø±Ø§Ù‚Ø¨ Ø§Ù„Ø£Ø¹Ø±Ø§Ø¶\nâ€¢ Ø§ØªØµÙ„ Ø¨Ø§Ù„Ø·Ø¨ÙŠØ¨ Ø¥Ø°Ø§ Ø³Ø§Ø¡Øª Ø§Ù„Ø­Ø§Ù„Ø©\n\n**Ù…ØªÙ‰ ØªØ·Ù„Ø¨ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©:**\nâ€¢ ØµØ¹ÙˆØ¨Ø© Ø´Ø¯ÙŠØ¯Ø© ÙÙŠ Ø§Ù„ØªÙ†ÙØ³\nâ€¢ Ø£Ù„Ù… Ù…Ø³ØªÙ…Ø± ÙÙŠ Ø§Ù„ØµØ¯Ø±\nâ€¢ ØªØ´ÙˆØ´ Ø°Ù‡Ù†ÙŠ\nâ€¢ Ø´ÙØ§Ù‡ Ø£Ùˆ ÙˆØ¬Ù‡ Ù…Ø²Ø±Ù‚\n\nâš ï¸ Ø§ØªØ¨Ø¹ Ø¥Ø±Ø´Ø§Ø¯Ø§Øª ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØµØ­Ø© Ø§Ù„Ù…Ø­Ù„ÙŠØ©.";
                }

                // Default response for unclear questions
                return "ğŸ¤– **Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø·Ø¨ÙŠ Ø§Ù„Ø°ÙƒÙŠ!**\n\nÙ„Ù… Ø£ÙÙ‡Ù… Ø³Ø¤Ø§Ù„Ùƒ Ø¨ÙˆØ¶ÙˆØ­. ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ ÙÙŠ:\n\nâ€¢ **Ø§Ù„Ø£Ø¹Ø±Ø§Ø¶ Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©** (ØµØ¯Ø§Ø¹ØŒ Ø­Ù…Ù‰ØŒ Ø³Ø¹Ø§Ù„ØŒ Ø£Ù„Ù… Ù…Ø¹Ø¯Ø©)\nâ€¢ **Ø§Ù„Ø¥Ø³Ø¹Ø§ÙØ§Øª Ø§Ù„Ø£ÙˆÙ„ÙŠØ©** (Ø­Ø±ÙˆÙ‚ØŒ Ø¬Ø±ÙˆØ­ØŒ Ø¥ØºÙ…Ø§Ø¡ØŒ Ø§Ø®ØªÙ†Ø§Ù‚)\nâ€¢ **Ø§Ù„Ù†ØµØ§Ø¦Ø­ Ø§Ù„ØµØ­ÙŠØ©** (Ù†ÙˆÙ…ØŒ ØªØºØ°ÙŠØ©ØŒ Ø±ÙŠØ§Ø¶Ø©)\nâ€¢ **Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø·Ø¨ÙŠØ©** (Ø£Ø¯ÙˆÙŠØ©ØŒ ÙÙŠØ±ÙˆØ³Ø§ØªØŒ Ø³ÙƒØ±ÙŠ)\n\n**Ø£Ù…Ø«Ù„Ø© Ø¹Ù„Ù‰ Ø£Ø³Ø¦Ù„Ø© ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø¹Ù„ÙŠÙ‡Ø§:**\nâ€¢ \"Ø¹Ù†Ø¯ÙŠ ØµØ¯Ø§Ø¹ Ø´Ø¯ÙŠØ¯\"\nâ€¢ \"Ø¥Ø²Ø§ÙŠ Ø£ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø­Ø±ÙˆÙ‚ØŸ\"\nâ€¢ \"Ù†ØµØ§Ø¦Ø­ Ù„Ù„Ù†ÙˆÙ… Ø§Ù„Ø¬ÙŠØ¯\"\nâ€¢ \"Ø£Ø¹Ø±Ø§Ø¶ ÙƒÙˆØ±ÙˆÙ†Ø§ Ø¥ÙŠÙ‡ØŸ\"\n\n**Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© Ø£ÙØ¶Ù„:**\nâ€¢ Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ùƒ Ø¨ÙˆØ¶ÙˆØ­\nâ€¢ Ø§Ø°ÙƒØ± Ø§Ù„Ø£Ø¹Ø±Ø§Ø¶ Ø§Ù„ØªÙŠ ØªØ´Ø¹Ø± Ø¨Ù‡Ø§\nâ€¢ Ø­Ø¯Ø¯ Ù…ØªÙ‰ Ø¨Ø¯Ø£Øª Ø§Ù„Ù…Ø´ÙƒÙ„Ø©\n\nâš ï¸ **ØªØ°ÙƒØ±:** Ø£Ù†Ø§ Ù„Ø§ Ø£ØºÙ†ÙŠ Ø¹Ù† Ø§Ø³ØªØ´Ø§Ø±Ø© Ø§Ù„Ø·Ø¨ÙŠØ¨ Ø§Ù„Ù…Ø®ØªØµ.\n\nØ¬Ø±Ø¨ ÙƒØªØ§Ø¨Ø© Ø³Ø¤Ø§Ù„Ùƒ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ø¨Ø·Ø±ÙŠÙ‚Ø© Ø£ÙˆØ¶Ø­! ğŸ˜Š";
            }

            // Generate nutrition plan
            function generateNutritionPlan(messageLower) {
                console.log('generateNutritionPlan called with:', messageLower);
                const nutritionData = {
                    'Ø§Ù„Ø³ÙƒØ±ÙŠ': {
                        name: 'Ù†Ø¸Ø§Ù… ØºØ°Ø§Ø¦ÙŠ Ù„Ù…Ø±Ø¶Ù‰ Ø§Ù„Ø³ÙƒØ±ÙŠ',
                        description: 'Ù†Ø¸Ø§Ù… ØºØ°Ø§Ø¦ÙŠ Ù…ØªÙˆØ§Ø²Ù† Ù„Ù„ØªØ­ÙƒÙ… ÙÙŠ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø³ÙƒØ±',
                        allowedFoods: [
                            'Ø§Ù„Ø®Ø¶Ø±ÙˆØ§Øª Ø§Ù„ÙˆØ±Ù‚ÙŠØ© (Ø³Ø¨Ø§Ù†Ø®ØŒ Ø¬Ø±Ø¬ÙŠØ±ØŒ Ø®Ø³)',
                            'Ø§Ù„Ø¨Ø±ÙˆØªÙŠÙ†Ø§Øª Ø§Ù„Ø®Ø§Ù„ÙŠØ© Ù…Ù† Ø§Ù„Ø¯Ù‡ÙˆÙ† (Ø¯Ø¬Ø§Ø¬ØŒ Ø³Ù…ÙƒØŒ Ø¨Ù‚ÙˆÙ„ÙŠØ§Øª)',
                            'Ø§Ù„Ø­Ø¨ÙˆØ¨ Ø§Ù„ÙƒØ§Ù…Ù„Ø© (Ø´ÙˆÙØ§Ù†ØŒ Ø£Ø±Ø² Ø¨Ù†ÙŠØŒ Ø®Ø¨Ø² Ø£Ø³Ù…Ø±)',
                            'Ø§Ù„Ù…ÙƒØ³Ø±Ø§Øª (Ù„ÙˆØ²ØŒ Ø¬ÙˆØ²ØŒ Ø¨Ø°ÙˆØ±)',
                            'Ø§Ù„ÙÙˆØ§ÙƒÙ‡ Ù‚Ù„ÙŠÙ„Ø© Ø§Ù„Ø³ÙƒØ± (ØªÙØ§Ø­ØŒ ÙƒÙ…Ø«Ø±Ù‰ØŒ ØªÙˆØª)'
                        ],
                        avoidFoods: [
                            'Ø§Ù„Ø³ÙƒØ±ÙŠØ§Øª Ø§Ù„Ù…ÙƒØ±Ø±Ø© ÙˆØ§Ù„Ø­Ù„ÙˆÙŠØ§Øª',
                            'Ø§Ù„Ù…Ø´Ø±ÙˆØ¨Ø§Øª Ø§Ù„ØºØ§Ø²ÙŠØ© ÙˆØ§Ù„Ø¹ØµØ§Ø¦Ø± Ø§Ù„Ù…Ø­Ù„Ø§Ø©',
                            'Ø§Ù„Ø®Ø¨Ø² Ø§Ù„Ø£Ø¨ÙŠØ¶ ÙˆØ§Ù„Ø£Ø±Ø² Ø§Ù„Ø£Ø¨ÙŠØ¶',
                            'Ø§Ù„Ø£Ø·Ø¹Ù…Ø© Ø§Ù„Ù…Ù‚Ù„ÙŠØ© ÙˆØ§Ù„Ø¯Ù‡Ù†ÙŠØ©',
                            'Ø§Ù„ÙÙˆØ§ÙƒÙ‡ Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ø³ÙƒØ± (Ø¹Ù†Ø¨ØŒ ØªÙŠÙ†ØŒ ØªÙ…Ø± Ø¨ÙƒØ«Ø±Ø©)'
                        ],
                        mealPlan: {
                            breakfast: 'Ø´ÙˆÙØ§Ù† Ø¨Ø§Ù„Ø­Ù„ÙŠØ¨ Ù‚Ù„ÙŠÙ„ Ø§Ù„Ø¯Ø³Ù… + Ø­Ø¨Ø© ÙØ§ÙƒÙ‡Ø© + Ù…ÙƒØ³Ø±Ø§Øª',
                            lunch: 'Ø³Ù„Ø·Ø© Ø®Ø¶Ø±Ø§Ø¡ + Ù‚Ø·Ø¹Ø© Ø¯Ø¬Ø§Ø¬ Ù…Ø´ÙˆÙŠ + Ø£Ø±Ø² Ø¨Ù†ÙŠ + Ø®Ø¶Ø§Ø± Ù…Ø·Ø¨ÙˆØ®Ø©',
                            dinner: 'Ø³Ù…Ùƒ Ù…Ø´ÙˆÙŠ + Ø®Ø¶Ø§Ø± Ø³ÙˆØªÙŠÙ‡ + Ø®Ø¨Ø² Ø£Ø³Ù…Ø±',
                            snacks: 'Ø®Ø¶Ø§Ø± Ù†ÙŠØ¦Ø©ØŒ Ù…ÙƒØ³Ø±Ø§ØªØŒ Ø²Ø¨Ø§Ø¯ÙŠ Ø·Ø¨ÙŠØ¹ÙŠ'
                        }
                    },
                    'Ø¶ØºØ· Ø§Ù„Ø¯Ù…': {
                        name: 'Ù†Ø¸Ø§Ù… DASH Ù„Ø¶ØºØ· Ø§Ù„Ø¯Ù…',
                        description: 'Ù†Ø¸Ø§Ù… ØºØ°Ø§Ø¦ÙŠ Ù„Ø®ÙØ¶ Ø¶ØºØ· Ø§Ù„Ø¯Ù… Ø§Ù„Ù…Ø±ØªÙØ¹',
                        allowedFoods: [
                            'Ø§Ù„ÙÙˆØ§ÙƒÙ‡ ÙˆØ§Ù„Ø®Ø¶Ø±ÙˆØ§Øª Ø§Ù„Ø·Ø§Ø²Ø¬Ø©',
                            'Ø§Ù„Ø­Ø¨ÙˆØ¨ Ø§Ù„ÙƒØ§Ù…Ù„Ø©',
                            'Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ø£Ù„Ø¨Ø§Ù† Ù‚Ù„ÙŠÙ„Ø© Ø§Ù„Ø¯Ø³Ù…',
                            'Ø§Ù„Ø¨Ø±ÙˆØªÙŠÙ†Ø§Øª Ø§Ù„Ø®Ø§Ù„ÙŠØ© Ù…Ù† Ø§Ù„Ø¯Ù‡ÙˆÙ†',
                            'Ø§Ù„Ù…ÙƒØ³Ø±Ø§Øª ÙˆØ§Ù„Ø¨Ø°ÙˆØ±'
                        ],
                        avoidFoods: [
                            'Ø§Ù„Ù…Ù„Ø­ ÙˆØ§Ù„Ø£Ø·Ø¹Ù…Ø© Ø§Ù„Ù…Ø§Ù„Ø­Ø©',
                            'Ø§Ù„Ø£Ø·Ø¹Ù…Ø© Ø§Ù„Ù…ØµÙ†Ø¹Ø© ÙˆØ§Ù„Ù…Ø¹Ù„Ø¨Ø©',
                            'Ø§Ù„Ù„Ø­ÙˆÙ… Ø§Ù„Ø­Ù…Ø±Ø§Ø¡ Ø§Ù„Ø¯Ù‡Ù†ÙŠØ©',
                            'Ø§Ù„Ø­Ù„ÙˆÙŠØ§Øª ÙˆØ§Ù„Ø³ÙƒØ±ÙŠØ§Øª',
                            'Ø§Ù„ÙƒØ§ÙÙŠÙŠÙ† Ø§Ù„Ø²Ø§Ø¦Ø¯'
                        ],
                        mealPlan: {
                            breakfast: 'Ø´ÙˆÙØ§Ù† Ø¨Ø§Ù„ÙÙˆØ§ÙƒÙ‡ + Ø­Ù„ÙŠØ¨ Ù‚Ù„ÙŠÙ„ Ø§Ù„Ø¯Ø³Ù…',
                            lunch: 'Ø³Ù„Ø·Ø© ÙƒØ¨ÙŠØ±Ø© + Ø¯Ø¬Ø§Ø¬ Ù…Ø´ÙˆÙŠ + Ø£Ø±Ø² Ø¨Ù†ÙŠ',
                            dinner: 'Ø³Ù…Ùƒ + Ø®Ø¶Ø§Ø± Ù…Ø´ÙˆÙŠØ© + Ø¨Ø·Ø§Ø·Ø§ Ù…Ø³Ù„ÙˆÙ‚Ø©',
                            snacks: 'ÙÙˆØ§ÙƒÙ‡ Ø·Ø§Ø²Ø¬Ø©ØŒ Ù…ÙƒØ³Ø±Ø§Øª ØºÙŠØ± Ù…Ù…Ù„Ø­Ø©'
                        }
                    },
                    'Ø¥Ù†Ù‚Ø§Øµ Ø§Ù„ÙˆØ²Ù†': {
                        name: 'Ù†Ø¸Ø§Ù… ØºØ°Ø§Ø¦ÙŠ Ù„Ø¥Ù†Ù‚Ø§Øµ Ø§Ù„ÙˆØ²Ù†',
                        description: 'Ù†Ø¸Ø§Ù… Ù…ØªÙˆØ§Ø²Ù† ÙˆØµØ­ÙŠ Ù„ÙÙ‚Ø¯Ø§Ù† Ø§Ù„ÙˆØ²Ù† Ø§Ù„ØªØ¯Ø±ÙŠØ¬ÙŠ',
                        allowedFoods: [
                            'Ø§Ù„Ø®Ø¶Ø±ÙˆØ§Øª Ø§Ù„ÙˆØ±Ù‚ÙŠØ© ÙˆØ§Ù„Ù…Ù„ÙˆÙ†Ø©',
                            'Ø§Ù„Ø¨Ø±ÙˆØªÙŠÙ†Ø§Øª Ø§Ù„Ø®Ø§Ù„ÙŠØ© Ù…Ù† Ø§Ù„Ø¯Ù‡ÙˆÙ†',
                            'Ø§Ù„ÙÙˆØ§ÙƒÙ‡ Ø§Ù„Ø·Ø§Ø²Ø¬Ø©',
                            'Ø§Ù„Ø­Ø¨ÙˆØ¨ Ø§Ù„ÙƒØ§Ù…Ù„Ø© Ø¨ÙƒÙ…ÙŠØ§Øª Ù…Ø­Ø¯ÙˆØ¯Ø©',
                            'Ø§Ù„Ù…Ø§Ø¡ ÙˆØ§Ù„Ø´Ø§ÙŠ Ø§Ù„Ø£Ø®Ø¶Ø±'
                        ],
                        avoidFoods: [
                            'Ø§Ù„Ø£Ø·Ø¹Ù…Ø© Ø§Ù„Ù…Ù‚Ù„ÙŠØ© ÙˆØ§Ù„Ø¯Ù‡Ù†ÙŠØ©',
                            'Ø§Ù„Ø­Ù„ÙˆÙŠØ§Øª ÙˆØ§Ù„Ø³ÙƒØ±ÙŠØ§Øª',
                            'Ø§Ù„Ù…Ø´Ø±ÙˆØ¨Ø§Øª Ø§Ù„ØºØ§Ø²ÙŠØ©',
                            'Ø§Ù„ÙˆØ¬Ø¨Ø§Øª Ø§Ù„Ø³Ø±ÙŠØ¹Ø©',
                            'Ø§Ù„Ø®Ø¨Ø² Ø§Ù„Ø£Ø¨ÙŠØ¶ ÙˆØ§Ù„Ù…Ø¹Ø¬Ù†Ø§Øª'
                        ],
                        mealPlan: {
                            breakfast: 'Ø¨ÙŠØ¶ØªØ§Ù† Ù…Ø³Ù„ÙˆÙ‚ØªØ§Ù† + Ø®Ø¶Ø§Ø± + Ø´Ø§ÙŠ Ø£Ø®Ø¶Ø±',
                            lunch: 'Ø³Ù„Ø·Ø© ÙƒØ¨ÙŠØ±Ø© + Ù‚Ø·Ø¹Ø© Ø¯Ø¬Ø§Ø¬ Ù…Ø´ÙˆÙŠ',
                            dinner: 'Ø´ÙˆØ±Ø¨Ø© Ø®Ø¶Ø§Ø± + Ø³Ù…Ùƒ Ù…Ø´ÙˆÙŠ',
                            snacks: 'Ø®Ø¶Ø§Ø± Ù†ÙŠØ¦Ø©ØŒ ÙÙˆØ§ÙƒÙ‡ Ù‚Ù„ÙŠÙ„Ø© Ø§Ù„Ø³ÙƒØ±'
                        }
                    }
                };

                // ØªØ­Ø¯ÙŠØ¯ Ù†ÙˆØ¹ Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„ØºØ°Ø§Ø¦ÙŠ
                let dietType = '';
                if (messageLower.includes('Ø³ÙƒØ±ÙŠ') || messageLower.includes('Ø³ÙƒØ±') || messageLower.includes('Ù†Ø¸Ø§Ù… Ø§Ù„Ø³ÙƒØ±ÙŠ')) {
                    dietType = 'Ø§Ù„Ø³ÙƒØ±ÙŠ';
                } else if (messageLower.includes('Ø¶ØºØ·') || messageLower.includes('Ø¶ØºØ· Ø§Ù„Ø¯Ù…')) {
                    dietType = 'Ø¶ØºØ· Ø§Ù„Ø¯Ù…';
                } else if (messageLower.includes('Ø¥Ù†Ù‚Ø§Øµ') || messageLower.includes('ØªØ®Ø³ÙŠØ³') || messageLower.includes('Ø±ÙŠØ¬ÙŠÙ…') ||
                          messageLower.includes('Ø¥Ù†Ù‚Ø§Øµ Ø§Ù„ÙˆØ²Ù†') || messageLower.includes('ØªÙ†Ø­ÙŠÙ')) {
                    dietType = 'Ø¥Ù†Ù‚Ø§Øµ Ø§Ù„ÙˆØ²Ù†';
                } else {
                    return "ğŸ¥— **Ø§Ù„Ø£Ù†Ø¸Ù…Ø© Ø§Ù„ØºØ°Ø§Ø¦ÙŠØ© Ø§Ù„Ù…ØªØ§Ø­Ø©:**\n\nâ€¢ Ù†Ø¸Ø§Ù… ØºØ°Ø§Ø¦ÙŠ Ù„Ù„Ø³ÙƒØ±ÙŠ\nâ€¢ Ù†Ø¸Ø§Ù… ØºØ°Ø§Ø¦ÙŠ Ù„Ø¶ØºØ· Ø§Ù„Ø¯Ù…\nâ€¢ Ù†Ø¸Ø§Ù… ØºØ°Ø§Ø¦ÙŠ Ù„Ø¥Ù†Ù‚Ø§Øµ Ø§Ù„ÙˆØ²Ù†\n\nØ§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø°ÙŠ ØªØ±ÙŠØ¯Ù‡ Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ØªÙØ§ØµÙŠÙ„ ÙƒØ§Ù…Ù„Ø©.\n\n**Ø£Ùˆ Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø³Ø±ÙŠØ¹Ø© Ø£Ø¹Ù„Ø§Ù‡! ğŸ‘†**";
                }

                const diet = nutritionData[dietType];
                if (!diet) {
                    return "Ø¹Ø°Ø±Ø§Ù‹ØŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ù…ØªØ§Ø­Ø© Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„ØºØ°Ø§Ø¦ÙŠ.";
                }

                let response = `ğŸ **${diet.name}**\n\n`;
                response += `**Ø§Ù„ÙˆØµÙ:** ${diet.description}\n\n`;

                response += "**âœ… Ø§Ù„Ø£Ø·Ø¹Ù…Ø© Ø§Ù„Ù…Ø³Ù…ÙˆØ­Ø©:**\n";
                diet.allowedFoods.forEach(food => {
                    response += `â€¢ ${food}\n`;
                });

                response += "\n**âŒ Ø§Ù„Ø£Ø·Ø¹Ù…Ø© Ø§Ù„Ù…ØªØ¬Ù†Ø¨Ø©:**\n";
                diet.avoidFoods.forEach(food => {
                    response += `â€¢ ${food}\n`;
                });

                response += "\n**ğŸ“… Ø®Ø·Ø© Ø§Ù„ÙˆØ¬Ø¨Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ©:**\n";
                response += `ğŸŒ… **Ø§Ù„Ø¥ÙØ·Ø§Ø±:** ${diet.mealPlan.breakfast}\n`;
                response += `ğŸŒ **Ø§Ù„ØºØ¯Ø§Ø¡:** ${diet.mealPlan.lunch}\n`;
                response += `ğŸŒ™ **Ø§Ù„Ø¹Ø´Ø§Ø¡:** ${diet.mealPlan.dinner}\n`;
                response += `ğŸ **Ø§Ù„ÙˆØ¬Ø¨Ø§Øª Ø§Ù„Ø®ÙÙŠÙØ©:** ${diet.mealPlan.snacks}\n\n`;

                response += "âš ï¸ **ØªÙ†Ø¨ÙŠÙ‡:** Ù‡Ø°Ù‡ ØªÙˆØµÙŠØ§Øª Ø¹Ø§Ù…Ø©. ÙŠÙÙ†ØµØ­ Ø¨Ø§Ø³ØªØ´Ø§Ø±Ø© Ø£Ø®ØµØ§Ø¦ÙŠ ØªØºØ°ÙŠØ© Ù„Ø®Ø·Ø© Ù…Ø®ØµØµØ© Ù„Ø­Ø§Ù„ØªÙƒ.";

                return response;
            }

            // Get first aid response
            function getFirstAidResponse(messageLower) {
                if (messageLower.includes('Ø­Ø±ÙˆÙ‚') || messageLower.includes('Ø­Ø±Ù‚')) {
                    return "ğŸ”¥ **Ø§Ù„Ø¥Ø³Ø¹Ø§ÙØ§Øª Ø§Ù„Ø£ÙˆÙ„ÙŠØ© Ù„Ù„Ø­Ø±ÙˆÙ‚:**\n\n**Ø®Ø·ÙˆØ§Øª ÙÙˆØ±ÙŠØ©:**\n1. Ø£Ø¨Ø¹Ø¯ Ù…ØµØ¯Ø± Ø§Ù„Ø­Ø±Ù‚ ÙÙˆØ±Ø§Ù‹\n2. Ø¶Ø¹ Ø§Ù„Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù…Ø­Ø±ÙˆÙ‚Ø© ØªØ­Øª Ø§Ù„Ù…Ø§Ø¡ Ø§Ù„Ø¨Ø§Ø±Ø¯ Ù„Ù…Ø¯Ø© 10-20 Ø¯Ù‚ÙŠÙ‚Ø©\n3. Ù„Ø§ ØªØ³ØªØ®Ø¯Ù… Ø§Ù„Ø«Ù„Ø¬ Ø£Ùˆ Ù…Ø¹Ø¬ÙˆÙ† Ø§Ù„Ø£Ø³Ù†Ø§Ù†\n4. ØºØ·ÙŠ Ø§Ù„Ø­Ø±Ù‚ Ø¨Ø´Ø§Ø´ Ù…Ø¹Ù‚Ù…\n5. Ù„Ø§ ØªÙÙ‚Ø¹ Ø§Ù„ÙÙ‚Ø§Ø¹Ø§Øª Ø¥Ù† ÙˆØ¬Ø¯Øª\n\n**Ù…ØªÙ‰ ØªØ°Ù‡Ø¨ Ù„Ù„Ø·ÙˆØ§Ø±Ø¦:**\nâ€¢ Ø­Ø±ÙˆÙ‚ Ø§Ù„Ø¯Ø±Ø¬Ø© Ø§Ù„Ø«Ø§Ù„Ø«Ø© (Ø¹Ù…ÙŠÙ‚Ø©)\nâ€¢ Ø­Ø±ÙˆÙ‚ ØªØºØ·ÙŠ Ù…Ø³Ø§Ø­Ø© ÙƒØ¨ÙŠØ±Ø©\nâ€¢ Ø­Ø±ÙˆÙ‚ ÙÙŠ Ø§Ù„ÙˆØ¬Ù‡ Ø£Ùˆ Ø§Ù„ÙŠØ¯ÙŠÙ†\nâ€¢ Ø­Ø±ÙˆÙ‚ ÙƒÙŠÙ…ÙŠØ§Ø¦ÙŠØ© Ø£Ùˆ ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©\n\nâš ï¸ Ù‡Ø°Ø§ Ù„Ø§ ÙŠØºÙ†ÙŠ Ø¹Ù† Ø§Ù„Ø±Ø¹Ø§ÙŠØ© Ø§Ù„Ø·Ø¨ÙŠØ© Ø§Ù„Ù…ØªØ®ØµØµØ©.";
                }

                if (messageLower.includes('Ø¬Ø±Ø­') || messageLower.includes('Ù†Ø²ÙŠÙ') || messageLower.includes('Ù‚Ø·Ø¹')) {
                    return "ğŸ©¸ **Ø§Ù„Ø¥Ø³Ø¹Ø§ÙØ§Øª Ø§Ù„Ø£ÙˆÙ„ÙŠØ© Ù„Ù„Ø¬Ø±ÙˆØ­:**\n\n**Ø®Ø·ÙˆØ§Øª ÙÙˆØ±ÙŠØ©:**\n1. Ø§ØºØ³Ù„ ÙŠØ¯ÙŠÙƒ Ø¬ÙŠØ¯Ø§Ù‹\n2. Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ø±Ø­ Ø¨Ù‚Ø·Ø¹Ø© Ù‚Ù…Ø§Ø´ Ù†Ø¸ÙŠÙØ©\n3. Ø§Ø±ÙØ¹ Ø§Ù„Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù…ØµØ§Ø¨Ø© ÙÙˆÙ‚ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ù‚Ù„Ø¨ Ø¥Ù† Ø£Ù…ÙƒÙ†\n4. Ù†Ø¸Ù Ø§Ù„Ø¬Ø±Ø­ Ø¨Ø§Ù„Ù…Ø§Ø¡ Ø§Ù„Ù†Ø¸ÙŠÙ\n5. Ø¶Ø¹ Ø¶Ù…Ø§Ø¯Ø© Ù…Ø¹Ù‚Ù…Ø©\n\n**Ù…ØªÙ‰ ØªØ°Ù‡Ø¨ Ù„Ù„Ø·ÙˆØ§Ø±Ø¦:**\nâ€¢ Ù†Ø²ÙŠÙ Ù„Ø§ ÙŠØªÙˆÙ‚Ù Ø¨Ø¹Ø¯ 10 Ø¯Ù‚Ø§Ø¦Ù‚ Ø¶ØºØ·\nâ€¢ Ø¬Ø±Ø­ Ø¹Ù…ÙŠÙ‚ ÙŠØ­ØªØ§Ø¬ Ø®ÙŠØ§Ø·Ø©\nâ€¢ Ø¬Ø±Ø­ Ù…Ù„ÙˆØ« Ø¨Ø§Ù„Ø£ÙˆØ³Ø§Ø®\nâ€¢ Ø¹Ù„Ø§Ù…Ø§Øª Ø¹Ø¯ÙˆÙ‰ (Ø§Ø­Ù…Ø±Ø§Ø±ØŒ ØªÙˆØ±Ù…ØŒ ØµØ¯ÙŠØ¯)\n\nâš ï¸ ØªØ£ÙƒØ¯ Ù…Ù† ØªØ­Ø¯ÙŠØ« ØªØ·Ø¹ÙŠÙ… Ø§Ù„ØªÙŠØªØ§Ù†ÙˆØ³.";
                }

                if (messageLower.includes('Ø¥ØºÙ…Ø§Ø¡') || messageLower.includes('ÙÙ‚Ø¯Ø§Ù† ÙˆØ¹ÙŠ') || messageLower.includes('Ø§ØºÙ…Ù‰')) {
                    return "ğŸ˜µ **Ø§Ù„Ø¥Ø³Ø¹Ø§ÙØ§Øª Ø§Ù„Ø£ÙˆÙ„ÙŠØ© Ù„Ù„Ø¥ØºÙ…Ø§Ø¡:**\n\n**Ø®Ø·ÙˆØ§Øª ÙÙˆØ±ÙŠØ©:**\n1. ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ù…ÙƒØ§Ù† Ø¢Ù…Ù†\n2. Ø¶Ø¹ Ø§Ù„Ø´Ø®Øµ Ø¹Ù„Ù‰ Ø¸Ù‡Ø±Ù‡\n3. Ø§Ø±ÙØ¹ Ø³Ø§Ù‚ÙŠÙ‡ 30 Ø³Ù… ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹\n4. ÙÙƒ Ø§Ù„Ù…Ù„Ø§Ø¨Ø³ Ø§Ù„Ø¶ÙŠÙ‚Ø©\n5. ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªÙ†ÙØ³ ÙˆØ§Ù„Ù†Ø¨Ø¶\n\n**Ø¥Ø°Ø§ Ù„Ù… ÙŠØ³ØªØ¹Ø¯ Ø§Ù„ÙˆØ¹ÙŠ Ø®Ù„Ø§Ù„ Ø¯Ù‚ÙŠÙ‚Ø©:**\nâ€¢ Ø§ØªØµÙ„ Ø¨Ø§Ù„Ø¥Ø³Ø¹Ø§Ù ÙÙˆØ±Ø§Ù‹\nâ€¢ Ø¶Ø¹Ù‡ ÙÙŠ ÙˆØ¶Ø¹ÙŠØ© Ø§Ù„Ø¥ÙØ§Ù‚Ø©\nâ€¢ Ø±Ø§Ù‚Ø¨ Ø§Ù„ØªÙ†ÙØ³ Ø¨Ø§Ø³ØªÙ…Ø±Ø§Ø±\n\n**Ù„Ø§ ØªÙØ¹Ù„:**\nâ€¢ Ù„Ø§ ØªØ±Ø´ Ø§Ù„Ù…Ø§Ø¡ Ø¹Ù„Ù‰ Ø§Ù„ÙˆØ¬Ù‡\nâ€¢ Ù„Ø§ ØªØ¹Ø·ÙŠ Ø£ÙŠ Ø·Ø¹Ø§Ù… Ø£Ùˆ Ø´Ø±Ø§Ø¨\nâ€¢ Ù„Ø§ ØªØªØ±ÙƒÙ‡ ÙˆØ­Ø¯Ù‡\n\nâš ï¸ Ø§Ù„Ø¥ØºÙ…Ø§Ø¡ Ù‚Ø¯ ÙŠÙƒÙˆÙ† Ø¹Ù„Ø§Ù…Ø© Ø¹Ù„Ù‰ Ø­Ø§Ù„Ø© Ø®Ø·ÙŠØ±Ø©.";
                }

                if (messageLower.includes('Ø§Ø®ØªÙ†Ø§Ù‚') || messageLower.includes('Ø´Ø±Ù‚Ø©')) {
                    return "ğŸ˜®â€ğŸ’¨ **Ø§Ù„Ø¥Ø³Ø¹Ø§ÙØ§Øª Ø§Ù„Ø£ÙˆÙ„ÙŠØ© Ù„Ù„Ø§Ø®ØªÙ†Ø§Ù‚:**\n\n**Ù„Ù„Ø´Ø®Øµ Ø§Ù„ÙˆØ§Ø¹ÙŠ:**\n1. Ø§Ø³Ø£Ù„: \"Ù‡Ù„ ØªØ®ØªÙ†Ù‚ØŸ\" Ø¥Ø°Ø§ Ù„Ù… ÙŠØ³ØªØ·Ø¹ Ø§Ù„ÙƒÙ„Ø§Ù…ØŒ ÙÙ‡Ùˆ ÙŠØ®ØªÙ†Ù‚\n2. Ù‚Ù Ø®Ù„ÙÙ‡ ÙˆØ§Ø­Ø· Ø°Ø±Ø§Ø¹ÙŠÙƒ Ø­ÙˆÙ„ Ø®ØµØ±Ù‡\n3. Ø¶Ø¹ Ù‚Ø¨Ø¶Ø© ÙŠØ¯ ÙÙˆÙ‚ Ø§Ù„Ø³Ø±Ø© Ù…Ø¨Ø§Ø´Ø±Ø©\n4. Ø§Ù…Ø³Ùƒ Ø§Ù„Ù‚Ø¨Ø¶Ø© Ø¨Ø§Ù„ÙŠØ¯ Ø§Ù„Ø£Ø®Ø±Ù‰\n5. Ø§Ø¶ØºØ· Ø¨Ù‚ÙˆØ© Ù„Ù„Ø¯Ø§Ø®Ù„ ÙˆÙ„Ù„Ø£Ø¹Ù„Ù‰\n6. ÙƒØ±Ø± Ø­ØªÙ‰ ÙŠØ®Ø±Ø¬ Ø§Ù„Ø¬Ø³Ù… Ø§Ù„ØºØ±ÙŠØ¨\n\n**Ù„Ù„Ø±Ø¶Ø¹ (Ø£Ù‚Ù„ Ù…Ù† Ø³Ù†Ø©):**\nâ€¢ 5 Ø¶Ø±Ø¨Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„Ø¸Ù‡Ø±\nâ€¢ 5 Ø¶ØºØ·Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„ØµØ¯Ø±\n\n**Ø¥Ø°Ø§ ÙÙ‚Ø¯ Ø§Ù„ÙˆØ¹ÙŠ:**\nâ€¢ Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¥Ù†Ø¹Ø§Ø´ Ø§Ù„Ù‚Ù„Ø¨ÙŠ Ø§Ù„Ø±Ø¦ÙˆÙŠ\nâ€¢ Ø§ØªØµÙ„ Ø¨Ø§Ù„Ø¥Ø³Ø¹Ø§Ù\n\nâš ï¸ ØªØ¹Ù„Ù… Ù‡Ø°Ù‡ Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª Ø¹Ù…Ù„ÙŠØ§Ù‹ Ù…Ù† Ù…Ø¯Ø±Ø¨ Ù…Ø¤Ù‡Ù„.";
                }

                return null;
            }

            // Add message to chat
            function addMessage(text, sender, isError = false) {
                const messageDiv = document.createElement('div');
                messageDiv.className = `message ${sender}`;

                const avatar = document.createElement('div');
                avatar.className = 'message-avatar';
                avatar.innerHTML = sender === 'user' ? '<i class="fas fa-user"></i>' : '<i class="fas fa-robot"></i>';

                const content = document.createElement('div');
                content.className = 'message-content';

                if (isError) {
                    content.style.background = 'linear-gradient(45deg, #dc3545, #c82333)';
                    content.style.color = 'white';
                }

                // Format message text (convert line breaks, etc.)
                content.innerHTML = formatMessageText(text);

                const time = document.createElement('div');
                time.className = 'message-time';
                time.textContent = new Date().toLocaleTimeString('ar-EG', {
                    hour: '2-digit',
                    minute: '2-digit'
                });

                content.appendChild(time);
                messageDiv.appendChild(avatar);
                messageDiv.appendChild(content);

                chatMessages.appendChild(messageDiv);

                // Scroll to bottom
                chatMessages.scrollTop = chatMessages.scrollHeight;

                // Add to chat history
                chatHistory.push({
                    text: text,
                    sender: sender,
                    timestamp: new Date().toISOString(),
                    isError: isError
                });

                // Animate message appearance
                messageDiv.style.opacity = '0';
                messageDiv.style.transform = 'translateY(20px)';
                setTimeout(() => {
                    messageDiv.style.transition = 'all 0.3s ease';
                    messageDiv.style.opacity = '1';
                    messageDiv.style.transform = 'translateY(0)';
                }, 100);
            }

            // Format message text
            function formatMessageText(text) {
                return text
                    .replace(/\n/g, '<br>')
                    .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                    .replace(/\*(.*?)\*/g, '<em>$1</em>')
                    .replace(/(https?:\/\/[^\s]+)/g, '<a href="$1" target="_blank">$1</a>');
            }

            // Show/Hide typing indicator
            function showTypingIndicator() {
                isTyping = true;
                typingIndicator.style.display = 'block';
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }

            function hideTypingIndicator() {
                isTyping = false;
                typingIndicator.style.display = 'none';
            }

            // Adjust textarea height
            function adjustTextareaHeight() {
                messageInput.style.height = 'auto';
                messageInput.style.height = Math.min(messageInput.scrollHeight, 120) + 'px';
            }

            // Emergency modal functions
            function containsEmergencyKeyword(text) {
                const lowerText = text.toLowerCase();
                return emergencyKeywords.some(keyword => lowerText.includes(keyword));
            }

            // Clear chat function
            function clearChat() {
                if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ø³Ø­ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©ØŸ')) {
                    chatMessages.innerHTML = '';
                    chatHistory = [];
                    welcomeSection.style.display = 'block';
                    localStorage.removeItem('medicalChatHistory');
                }
            }

            // Export chat function
            function exportChat() {
                if (chatHistory.length === 0) {
                    alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø­Ø§Ø¯Ø«Ø© Ù„ØªØµØ¯ÙŠØ±Ù‡Ø§');
                    return;
                }

                const chatText = chatHistory.map(msg => {
                    const sender = msg.sender === 'user' ? 'Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…' : 'Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø·Ø¨ÙŠ';
                    const time = new Date(msg.timestamp).toLocaleString('ar-EG');
                    return `[${time}] ${sender}: ${msg.text}`;
                }).join('\n\n');

                const blob = new Blob([chatText], { type: 'text/plain;charset=utf-8' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `medical-chat-${new Date().toISOString().split('T')[0]}.txt`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }

            // Save/Load chat history
            function saveChatHistory() {
                localStorage.setItem('medicalChatHistory', JSON.stringify(chatHistory));
            }

            function loadChatHistory() {
                const saved = localStorage.getItem('medicalChatHistory');
                if (saved) {
                    chatHistory = JSON.parse(saved);

                    // Restore messages
                    chatHistory.forEach(msg => {
                        addMessageToDOM(msg.text, msg.sender, msg.isError);
                    });

                    if (chatHistory.length > 0) {
                        welcomeSection.style.display = 'none';
                    }
                }
            }

            // Add message to DOM without adding to history (for loading saved messages)
            function addMessageToDOM(text, sender, isError = false) {
                const messageDiv = document.createElement('div');
                messageDiv.className = `message ${sender}`;

                const avatar = document.createElement('div');
                avatar.className = 'message-avatar';
                avatar.innerHTML = sender === 'user' ? '<i class="fas fa-user"></i>' : '<i class="fas fa-robot"></i>';

                const content = document.createElement('div');
                content.className = 'message-content';

                if (isError) {
                    content.style.background = 'linear-gradient(45deg, #dc3545, #c82333)';
                    content.style.color = 'white';
                }

                content.innerHTML = formatMessageText(text);

                messageDiv.appendChild(avatar);
                messageDiv.appendChild(content);
                chatMessages.appendChild(messageDiv);
            }

            // Authentication check
            checkAuthStatus();

            function checkAuthStatus() {
                const userData = localStorage.getItem('currentUser');
                if (userData) {
                    const user = JSON.parse(userData);
                    document.getElementById('userMenuContainer').style.display = 'block';
                    document.getElementById('loginMenuContainer').style.display = 'none';
                    document.getElementById('userDisplayName').textContent = user.name;

                    // Show welcome message for logged in users
                    setTimeout(() => {
                        if (chatHistory.length === 0) {
                            addMessage(`Ù…Ø±Ø­Ø¨Ø§Ù‹ ${user.name}! ğŸ‘‹\n\nğŸ¤– **Ø£Ù†Ø§ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø·Ø¨ÙŠ Ø§Ù„Ø°ÙƒÙŠ**\n\nØ¬Ø§Ù‡Ø² Ù„Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ ÙÙŠ:\nâ€¢ Ø§Ù„Ø£Ø¹Ø±Ø§Ø¶ ÙˆØ§Ù„Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„ØµØ­ÙŠØ©\nâ€¢ Ø§Ù„Ø¥Ø³Ø¹Ø§ÙØ§Øª Ø§Ù„Ø£ÙˆÙ„ÙŠØ©\nâ€¢ Ø§Ù„Ù†ØµØ§Ø¦Ø­ Ø§Ù„Ø·Ø¨ÙŠØ© ÙˆØ§Ù„ØµØ­ÙŠØ©\nâ€¢ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¹Ù† Ø§Ù„Ø£Ø¯ÙˆÙŠØ© ÙˆØ§Ù„Ø¹Ù„Ø§Ø¬Ø§Øª\n\nğŸ’¡ **Ù†ØµÙŠØ­Ø©:** ÙƒÙ† Ù…Ø­Ø¯Ø¯Ø§Ù‹ ÙÙŠ ÙˆØµÙ Ø£Ø¹Ø±Ø§Ø¶Ùƒ Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø£ÙØ¶Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø©.\n\nâš ï¸ **ØªØ°ÙƒØ±:** Ø£Ù†Ø§ Ù„Ø§ Ø£ØºÙ†ÙŠ Ø¹Ù† Ø§Ø³ØªØ´Ø§Ø±Ø© Ø§Ù„Ø·Ø¨ÙŠØ¨ Ø§Ù„Ù…Ø®ØªØµ.\n\nÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ Ø§Ù„ÙŠÙˆÙ…ØŸ`, 'bot');
                            welcomeSection.style.display = 'none';
                        }
                    }, 1000);
                } else {
                    document.getElementById('userMenuContainer').style.display = 'none';
                    document.getElementById('loginMenuContainer').style.display = 'block';

                    // Show guest welcome message
                    setTimeout(() => {
                        if (chatHistory.length === 0) {
                            addMessage('Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø·Ø¨ÙŠ Ø§Ù„Ø°ÙƒÙŠ! ğŸ¤–\n\n**ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø¢Ù† Ù…Ø¨Ø§Ø´Ø±Ø©!**\n\nØ£Ù†Ø§ Ø¬Ø§Ù‡Ø² Ù„Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ ÙÙŠ:\nâ€¢ Ø§Ù„Ø£Ø¹Ø±Ø§Ø¶ ÙˆØ§Ù„Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„ØµØ­ÙŠØ©\nâ€¢ Ø§Ù„Ø¥Ø³Ø¹Ø§ÙØ§Øª Ø§Ù„Ø£ÙˆÙ„ÙŠØ©\nâ€¢ Ø§Ù„Ù†ØµØ§Ø¦Ø­ Ø§Ù„Ø·Ø¨ÙŠØ©\nâ€¢ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¹Ù† Ø§Ù„Ø£Ø¯ÙˆÙŠØ©\n\nğŸ’¡ **Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ØªØ¬Ø±Ø¨Ø© Ø£ÙØ¶Ù„:**\nâ€¢ Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„Ùƒ Ù„Ø­ÙØ¸ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª\nâ€¢ Ø§Ø­Ø¬Ø² Ù…ÙˆØ§Ø¹ÙŠØ¯ Ù…Ø¹ Ø§Ù„Ø£Ø·Ø¨Ø§Ø¡\nâ€¢ Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ù…Ù„Ù Ø·Ø¨ÙŠ Ø´Ø®ØµÙŠ\n\nâš ï¸ **ØªØ°ÙƒØ±:** Ø£Ù†Ø§ Ù„Ø§ Ø£ØºÙ†ÙŠ Ø¹Ù† Ø§Ø³ØªØ´Ø§Ø±Ø© Ø§Ù„Ø·Ø¨ÙŠØ¨ Ø§Ù„Ù…Ø®ØªØµ.\n\nØ§Ø¨Ø¯Ø£ Ø¨ÙƒØªØ§Ø¨Ø© Ø³Ø¤Ø§Ù„Ùƒ Ø£Ùˆ Ø§Ø®ØªØ± Ù…Ù† Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø£Ø¹Ù„Ø§Ù‡! ğŸ‘†', 'bot');
                            welcomeSection.style.display = 'none';
                        }
                    }, 1000);
                }
            }

            // Logout functionality
            document.getElementById('logoutBtn')?.addEventListener('click', function(e) {
                e.preventDefault();
                localStorage.removeItem('currentUser');
                localStorage.removeItem('rememberUser');
                checkAuthStatus();
                showAlert('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ø¨Ù†Ø¬Ø§Ø­', 'info');
            });

            function showAlert(message, type) {
                const alertDiv = document.createElement('div');
                alertDiv.className = `alert alert-${type} alert-dismissible fade show position-fixed`;
                alertDiv.style.cssText = 'top: 20px; right: 20px; z-index: 9999; min-width: 300px;';
                alertDiv.innerHTML = `
                    ${message}
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                `;
                document.body.appendChild(alertDiv);
                setTimeout(() => {
                    if (alertDiv.parentNode) {
                        alertDiv.remove();
                    }
                }, 5000);
            }
        });
    </script>
</body>
</html>
